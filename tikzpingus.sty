\def\filename{tikzpingus}
\ProvidesPackage{\filename}[2021/04/30 version v1.0 Penguins in TikZ]

\RequirePackage{tikz}
\usetikzlibrary{intersections}

\pgfdeclarelayer{background}\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}

\def\@pingu@color@ #1#2(#3,#4,#5){\definecolor{pingu@#1}{#2}{#3,#4,#5}}
\@pingu@color@{main}RGB(3,14,29)
\@pingu@color@{black}RGB(23,19,19)
\@pingu@color@{white}RGB(248,248,248)
\@pingu@color@{yellow}RGB(252,187,21)
\@pingu@color@{blue}RGB(174,229,243)
\def\@pingu@none{!hide}

\newdimen\pingu@one@eight     \pingu@one@eight=.125cm\relax
\newdimen\pingu@w@half        \pingu@w@half=\dimexpr1cm-.5\pingu@one@eight\relax
\newdimen\pingu@side@h@half   \pingu@side@h@half=1.275cm\relax
\newdimen\pingu@bend          \pingu@bend=\pingu@one@eight\relax
\newdimen\pingu@lower@off     \pingu@lower@off=.25cm\relax
\newdimen\pingu@outer@off     \pingu@outer@off=.25cm\relax
\def\basicfeetbend{45}
\newdimen\pingu@foot@outer@w  \pingu@foot@outer@w=.45cm\relax
\newdimen\pingu@foot@outer@h  \pingu@foot@outer@h=.25cm\relax

\newdimen\pingu@foot@inner@w  \pingu@foot@inner@w=.55cm\relax
\newdimen\pingu@foot@inner@h  \pingu@foot@inner@h=.115cm\relax
\newdimen\pingu@foot@offset@w \pingu@foot@offset@w=-\pingu@one@eight\relax
\newdimen\pingu@foot@single@w \pingu@foot@single@w=.105cm\relax
\newdimen\pingu@foot@single@h \pingu@foot@single@h=.2cm\relax
\def\eyebaseang{38.5}
\newdimen\pingu@eye@shift     \pingu@eye@shift=.08cm\relax

\def\pingu@csappto#1#2{\expandafter\ifx\csname #1\endcsname\@empty\@namedef{#1}{#2}\else\expandafter\g@addto@macro\csname #1\endcsname{, #2}\fi}

\def\pingu@create@sel@err#1#2{%
    \PackageError{\filename}{There is no '#2' drawer for '#1'. Choose one of '\@nameuse{@pingu@#1@}'}{Or ask the package maintainer :D}%
}

% #1 name; TODO: refactor
\def\pingu@create@selection#1{%
    \expandafter\let\csname @pingu@#1@\endcsname\@empty
    \expandafter\long\expandafter\def\csname pingu@#1@add\endcsname##1##2{%
        \pingu@csappto{@pingu@#1@}{##1}%
        \expandafter\long\expandafter\def\csname @pingu@drawer@#1@##1@\endcsname{##2}%
    }
    \expandafter\def\csname pingu@#1@select\endcsname##1{%
        \ifcsname @pingu@drawer@#1@##1@\endcsname
            \expandafter\let\csname @pingu@drawer@#1@\expandafter\endcsname\csname @pingu@drawer@#1@##1@\endcsname
        \else\pingu@create@sel@err{#1}{##1}\fi
    }%
    \csname pingu@#1@add\endcsname{none}{}%
}

\def\pingu@create@extra#1{\expandafter\newif\csname if@pingu@x@#1@\endcsname}
\def\pingu@set@extra#1#2{\csname @pingu@x@#1@#2\endcsname}

\pingu@create@selection{lefteye}
\pingu@create@selection{righteye}
\pingu@create@selection{leftwing}
\pingu@create@selection{rightwing}
\pingu@create@selection{hairstyle}
\pingu@create@selection{bill}

\pingu@create@extra{strawhat}
\pingu@create@extra{halo}

\def\pingu@color#1#2{\expandafter\def\csname pingu@color@#1\endcsname{#2}}

% HACK: store scale
\tikzset{/tikz/scale/.append code={\def\pingu@default@scale{#1}}}
\def\pingu@default@scale{1}

% TODO: other selections
\tikzset{%
  /pingu/.search also={/tikz,/pgf}, /pingu/.cd,%
  name/.code                    = \def\pingu@name{#1},
  scale/.code                   = \def\pingu@scale{#1},
  @block/.style                 = {fill=#1}, @pingu/.style = {},
  @text/.style                  = {transform shape,text=\pingu@color@body@main},
  % feet
  left foot/.code               = \pingu@color{foot@left}{#1},
  right foot/.code              = \pingu@color{foot@right}{#1},
  feet/.style                   = {/pingu/left foot={#1}, /pingu/right foot={#1}},
  % body
  body main/.code               = \pingu@color{body@main}{#1},
  body head/.code               = \pingu@color{body@head}{#1},
  body/.style                   = {/pingu/body main={#1}, /pingu/body head={#1}},
  % belly
  belly/.forward to             = /pingu/belly text,
  belly text/.style             = {/pingu/belly raw={\node[/pingu/@text] {#1};}},
  belly raw/.code               = \def\pingu@belly@raw{#1},
  % eyes
  left eye/.code                = \pingu@lefteye@select{#1},
  left eye color/.code          = \pingu@color{eye@left}{#1},
  left second eye color/.code   = \pingu@color{eye@second@left}{#1},
  right eye/.code               = \pingu@righteye@select{#1},
  right eye color/.code         = \pingu@color{eye@right}{#1},
  right second eye color/.code  = \pingu@color{eye@second@right}{#1},
  eyes/.style                   = {/pingu/left eye={#1}, /pingu/right eye={#1}},
  eyes color/.style             = {/pingu/left eye color={#1}, /pingu/right eye color={#1}},
  eyes wink/.style              = {/pingu/eyes={wink}, /pingu/eyes color={#1}},
  eyes wink/.default            = pingu@black,
  second eyes color/.style      = {/pingu/left second eye color={#1}, /pingu/right second eye color={#1}},
  % wings
  left wing color/.code         = \pingu@color{left@wing}{#1},
  left wing/.code               = \pingu@leftwing@select{#1},
  right wing color/.code        = \pingu@color{right@wing}{#1},
  right wing/.code              = \pingu@rightwing@select{#1},
  wings/.style                  = {/pingu/left wing={#1}, /pingu/right wing={#1}},
  wings grab/.style             = {/pingu/wings={grab}, /pingu/wings color={#1}},
  wings wave/.style             = {/pingu/wings={wave}, /pingu/wings color={#1}},
  wings grab/.default           = \pingu@color@body@main,
  wings wave/.default           = \pingu@color@body@main,
  wings color/.style            = {/pingu/left wing color={#1},
                                   /pingu/right wing color={#1}},
  % bill
  bill/.code                    = \pingu@bill@select{#1},
  bill color/.code              = \pingu@color{bill}{#1},
  % hair color TODO: other colors
  hair/.forward to              = /pingu/hairs color,
  hairs/.forward to             = /pingu/hairs color,
  hair 1/.forward to = /pingu/hair 1 color,
  hair 1 color/.code            = \pingu@color{hair@a}{#1},
  hair 2/.forward to = /pingu/hair 2 color,
  hair 2 color/.code            = \pingu@color{hair@b}{#1},
  hair 3/.forward to = /pingu/hair 3 color,
  hair 3 color/.code            = \pingu@color{hair@c}{#1},
  hair 4/.forward to = /pingu/hair 4 color,
  hair 4 color/.code            = \pingu@color{hair@d}{#1},
  hair 5/.forward to = /pingu/hair 5 color,
  hair 5 color/.code            = \pingu@color{hair@e}{#1},
  hairs color/.style            = {/pingu/hair 1 color={#1},
                                   /pingu/hair 2 color={#1},
                                   /pingu/hair 3 color={#1},
                                   /pingu/hair 4 color={#1},
                                   /pingu/hair 5 color={#1}},
  hair style/.forward to        = /pingu/hairstyle,
  hairstyle/.code               = \pingu@hairstyle@select{#1},
  % extra strawhat (tikzducks basis)
  straw hat/.forward to         = /pingu/strawhat,
  strawhat/.default             = brown!50!white,
  strawhat/.code                = \pingu@set@extra{strawhat}{true}\pingu@color{strawhat}{#1},
  straw hat ribbon/.forward to  = /pingu/strawhat ribbon,
  strawhat ribbon/.default      = gray!85!black, % TODO: colors
  strawhat ribbon/.code         = \pingu@color{strawhat@ribbon}{#1},
  straw hat position/.forward to= /pingu/strawhat position,
  strawhat position/.code args  = {#1:(#2,#3)#4}{\def\pingu@x@strawhat@angle{#1}\def\pingu@x@strawhat@xshift{#2}\def\pingu@x@strawhat@yshift{#3}\def\pingu@x@strawhat@scale{#4}},
  % extra halo
  halo/.code                    = \pingu@set@extra{halo}{true}\pingu@color{halo}{#1},
  halo/.default                 = pingu@blue,
  % TODO: glow color
  % size
  height/.code                  = \setlength{\pingu@side@h@half}{#1},%
  defaults/.style               = {%
    name={pingu}, feet={pingu@yellow}, body={pingu@main}, %
    eyes={normal}, eyes color={pingu@black}, second eyes color={pingu@white},
    bill={normal}, bill color={pingu@yellow},
    wings={normal}, wings color=\pingu@color@body@main,
    hairstyle={normal}, hairs color=\pingu@color@body@main,
    strawhat position={-26.5:(-.165cm,.13cm){1.35}},
    belly raw={}, scale=\pingu@default@scale,extra defaults%
  },
  extra defaults/.style         = {%
    strawhat ribbon,
  }
}
% TODO: free defaults

\long\def\pingu@path{\@dblarg\pingu@path@}
\def\pingu@path@[#1]#2#3;{\protected@edef\@tmp{#2}\ifx\@tmp\@pingu@none\else\path[#1,#2] #3;\fi}
\long\def\pingu@block{\@dblarg\pingu@block@}
\def\pingu@block@[#1]#2#3;{\protected@edef\@tmp{#2}\ifx\@tmp\@pingu@none\else\path[#1,/pingu/@block=#2] #3;\fi}


\newcommand*\pingu[1][]{\begingroup
\tikzset{/pingu/.cd, defaults, #1}%
\scope[/pingu/@pingu]
\@pingu@base

\pgfonlayer{background}
    \@pingu@drawer@hairstyle@
    \pingu@draw@feet
\endpgfonlayer

\@pingu@drawer@leftwing@
\@pingu@drawer@rightwing@

\coordinate (\pingu@name-belly-back) at (\pingu@w@half,-1cm);
\coordinate (\pingu@name-belly-center) at (\pingu@w@half,-.68\pingu@side@h@half);

\pingu@block[save path=\pingu@whitepingu]{pingu@white} (\pingu@name-belly-back)++(-\pingu@w@half+.1cm,\pingu@lower@off) to[bend right=.8\pingu@bend] ++(0,1.05cm-\pingu@side@h@half-\pingu@lower@off) arc (180:270:.4cm and .2cm) arc (270:360:.5cm and .085cm) -- ++(-\pingu@one@eight,0) arc (180:270:.5cm and .085cm) arc (270:360:.4cm and .2cm) to[bend right=.8\pingu@bend] ++(0,\pingu@side@h@half-1.05cm+\pingu@lower@off) arc (0:180:\pingu@w@half-.1cm and \pingu@w@half-.1cm);

\coordinate (\pingu@name-heartp-right) at ([xshift=-.275cm,yshift=.25cm-\pingu@outer@off]bottom-top-center);
\coordinate (\pingu@name-heartp-left) at ([xshift=.275cm,yshift=.25cm-\pingu@outer@off]bottom-top-center);
\pingu@block{pingu@white} (\pingu@name-heartp-right)++(0,-.025cm) ellipse [x radius=.525cm,y radius=.65cm];
\pingu@block{pingu@white} (\pingu@name-heartp-left)++(0,-.025cm) ellipse [x radius=.525cm,y radius=.65cm];

\coordinate (\pingu@name-head) at (\pingu@w@half,.7375cm);
% TODO: more lengths

\@pingu@drawer@lefteye@
\@pingu@drawer@righteye@

\@pingu@drawer@bill@

\scope[shift=(\pingu@name-belly-center)]
\clip[use path=\pingu@whitepingu];
\pingu@belly@raw
\endscope

\pingu@draw@extras@above

\endscope
\endgroup
}

\def\@pingu@base{%
    \pingu@block[save path=\pingu@lowerpingu]{\pingu@color@body@main} (0,\pingu@outer@off)
        % left side
        to[bend right=\pingu@bend] ++(0,-\pingu@side@h@half-\pingu@outer@off)
        % feety stuff
        arc (180:270:\pingu@foot@outer@w{} and \pingu@foot@outer@h) coordinate (\pingu@name-foot-right)
        arc (270:360:\pingu@foot@inner@w{} and \pingu@foot@inner@h) -- ++(\pingu@foot@offset@w,0)
        coordinate[pos=.5,yshift=-\pingu@foot@inner@h*\pingu@scale] (\pingu@name-bottom-center)
        arc (180:270:\pingu@foot@inner@w{} and \pingu@foot@inner@h) coordinate (\pingu@name-foot-left)
        arc (270:360:\pingu@foot@outer@w{} and \pingu@foot@outer@h)%
        % right side
        to[bend right=\pingu@bend] ++(0,\pingu@side@h@half+\pingu@outer@off)
        % coordinate
        coordinate (\pingu@name-wings-side-left)
        -- (0,\pingu@outer@off) coordinate (\pingu@name-wings-side-right) coordinate[pos=.5] (bottom-top-center) -- cycle;

    \pingu@block{\pingu@color@body@head} (bottom-top-center) ellipse[x radius=\pingu@w@half, y radius=.9\pingu@w@half];
    \coordinate (\pingu@name-head-top) at ([yshift=.9\pingu@w@half]bottom-top-center);
}

%%% eyes %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\pingu@lefteye@add{normal}{%
    \pingu@block{\pingu@color@eye@left} ([yshift=.075cm,xshift=\pingu@eye@shift]\pingu@name-heartp-left) coordinate (\pingu@name-left-eye) ellipse [x radius=.1225cm, y radius=.1275cm];
}
\pingu@righteye@add{normal}{%
    \pingu@block{\pingu@color@eye@right} ([yshift=.075cm,xshift=-\pingu@eye@shift]\pingu@name-heartp-right) coordinate(\pingu@name-right-eye) ellipse [x radius=.1225cm, y radius=.1275cm];
}
\pingu@lefteye@add{shiny}{%
    \pingu@block{\pingu@color@eye@left} ([yshift=.075cm,xshift=\pingu@eye@shift]\pingu@name-heartp-left) coordinate(\pingu@name-left-eye) ellipse [x radius=.22cm, y radius=.26cm];
    \pingu@block{\pingu@color@eye@second@left} (\pingu@name-left-eye)++(\eyebaseang:.085cm and .10cm) ellipse [x radius=.08cm, y radius=.1cm];
    \pingu@block{\pingu@color@eye@second@left} (\pingu@name-left-eye)++(\eyebaseang+180:.12cm and .14cm) ellipse [x radius=.025cm, y radius=.035cm];
}
\pingu@righteye@add{shiny}{%
    \pingu@block{\pingu@color@eye@right} ([yshift=.075cm,xshift=-\pingu@eye@shift]\pingu@name-heartp-right) coordinate(\pingu@name-right-eye) ellipse [x radius=.22cm, y radius=.26cm];
    \pingu@block{\pingu@color@eye@second@right} (\pingu@name-right-eye)++(\eyebaseang:.085cm and .10cm) ellipse [x radius=.08cm, y radius=.1cm];
    \pingu@block{\pingu@color@eye@second@right} (\pingu@name-right-eye)++(\eyebaseang+180:.12cm and .14cm) ellipse [x radius=.025cm, y radius=.035cm];
}
\pingu@lefteye@add{wink}{%
    \coordinate (\pingu@name-left-eye) at ([yshift=.075cm,xshift=\pingu@eye@shift]\pingu@name-heartp-left);
    \pingu@block[rounded corners=.002cm,rotate around={-4:(\pingu@name-left-eye)}]{\pingu@color@eye@left} (\pingu@name-left-eye)++(174:.14cm and .14cm)++(0,-.065cm) arc (174:6:.14cm and .14cm) arc (-6:-174:.01cm and .008cm) arc (6:174:.12cm and .065cm) arc (-6:-174:.01cm and .008cm) -- cycle;
}
\pingu@righteye@add{wink}{%
    \coordinate (\pingu@name-right-eye) at ([yshift=.075cm,xshift=-\pingu@eye@shift]\pingu@name-heartp-right);
    \pingu@block[rounded corners=.002cm,rotate around={4:(\pingu@name-right-eye)}]{\pingu@color@eye@right} (\pingu@name-right-eye)++(174:.14cm and .14cm)++(0,-.065cm) arc (174:6:.14cm and .14cm) arc (-6:-174:.01cm and .008cm) arc (6:174:.12cm and .065cm) arc (-6:-174:.01cm and .008cm) -- cycle;
}
\pingu@lefteye@add{shock}{%
    \pingu@block{\pingu@color@eye@left} ([yshift=.075cm,xshift=\pingu@eye@shift]\pingu@name-heartp-left) coordinate (\pingu@name-left-eye) ellipse [x radius=.1535cm, y radius=.1575cm];
    \pingu@block{\pingu@color@eye@second@left} ([yshift=.075cm,xshift=\pingu@eye@shift]\pingu@name-heartp-left) coordinate (\pingu@name-left-eye) ellipse [x radius=.1325cm, y radius=.1375cm];
}
\pingu@righteye@add{shock}{%
    \pingu@block{\pingu@color@eye@right} ([yshift=.075cm,xshift=-\pingu@eye@shift]\pingu@name-heartp-right) coordinate(\pingu@name-right-eye) ellipse [x radius=.1535cm, y radius=.1575cm];
    \pingu@block{\pingu@color@eye@second@right} ([yshift=.075cm,xshift=-\pingu@eye@shift]\pingu@name-heartp-right) coordinate(\pingu@name-right-eye) ellipse [x radius=.1325cm, y radius=.1375cm];
}

%%% Wings %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\pingu@leftwing@add{normal}{%
\pgfonlayer{background}
    \coordinate (\pingu@name-wings-left-start) at ([yshift=-.7cm]\pingu@name-wings-side-left);
    \pingu@block[rotate around={15:(\pingu@name-wings-left-start)}]{\pingu@color@left@wing} (\pingu@name-wings-left-start) ellipse [x radius=.195cm, y radius=.9cm] +(-90:.195cm and .9cm) coordinate (\pingu@name-wings-left-tip) +(-90:.145cm and .75cm) coordinate (\pingu@name-wings-left);
\endpgfonlayer}
\pingu@rightwing@add{normal}{%
\pgfonlayer{background}
    \coordinate (\pingu@name-wings-right-start) at ([yshift=-.7cm]\pingu@name-wings-side-right);
    \pingu@block[rotate around={-15:(\pingu@name-wings-right-start)}]{\pingu@color@right@wing} (\pingu@name-wings-right-start) ellipse [x radius=.195cm, y radius=.9cm] +(-90:.195cm and .9cm) coordinate (\pingu@name-wings-right-tip) +(-90:.145cm and .75cm) coordinate (\pingu@name-wings-right);
\endpgfonlayer}

\pingu@leftwing@add{wave}{%
\pgfonlayer{background}
    \coordinate (\pingu@name-wings-left-start) at ([yshift=-.6cm]\pingu@name-wings-side-left);
    \pingu@block[rotate around={-39:(\pingu@name-wings-left-start)}]{\pingu@color@left@wing} (\pingu@name-wings-left-start) ellipse [x radius=.225cm, y radius=.925cm] +(90:.225cm and .925cm) coordinate (\pingu@name-wings-left-tip) +(90:.175cm and .775cm) coordinate (\pingu@name-wings-left);
\endpgfonlayer
}
\pingu@rightwing@add{wave}{%
\pgfonlayer{background}
    \coordinate (\pingu@name-wings-right-start) at ([yshift=-.6cm]\pingu@name-wings-side-right);
    \pingu@block[rotate around={39:(\pingu@name-wings-right-start)}]{\pingu@color@right@wing} (\pingu@name-wings-right-start) ellipse [x radius=.225cm, y radius=.925cm] +(90:.225cm and .925cm) coordinate (\pingu@name-wings-right-tip) +(90:.175cm and .775cm) coordinate (\pingu@name-wings-right);
\endpgfonlayer
}
\pingu@leftwing@add{raise}{%
    \coordinate (\pingu@name-wings-left-start) at ([yshift=-.6cm]\pingu@name-wings-side-left);
    \pingu@block[rotate around={-17:(\pingu@name-wings-left-start)}]{\pingu@color@left@wing} (\pingu@name-wings-left-start) ellipse [x radius=.195cm, y radius=.925cm] +(90:.195cm and .925cm) coordinate (\pingu@name-wings-left-tip) +(90:.145cm and .775cm) coordinate (\pingu@name-wings-left);
}
\pingu@rightwing@add{raise}{%
    \coordinate (\pingu@name-wings-right-start) at ([yshift=-.6cm]\pingu@name-wings-side-right);
    \pingu@block[rotate around={17:(\pingu@name-wings-right-start)}]{\pingu@color@right@wing} (\pingu@name-wings-right-start) ellipse [x radius=.195cm, y radius=.925cm] +(90:.195cm and .925cm) coordinate (\pingu@name-wings-right-tip) +(90:.145cm and .775cm) coordinate (\pingu@name-wings-right);
}

\pingu@leftwing@add{grab}{%
\pgfonlayer{foreground}
\begin{scope}
    \clip[use path=\pingu@lowerpingu];
    \coordinate (\pingu@name-wings-left-start) at ([yshift=-.45cm]\pingu@name-wings-side-left);
    \pingu@block[rotate around={-42:(\pingu@name-wings-left-start)}]{\pingu@color@left@wing} (\pingu@name-wings-left-start) ellipse [x radius=.225cm, y radius=1.05cm] +(-90:.225cm and 1.05cm) coordinate (\pingu@name-wings-left-tip) +(-90:.175cm and .9cm) coordinate (\pingu@name-wings-left);
\end{scope}\endpgfonlayer}
\pingu@rightwing@add{grab}{%
\pgfonlayer{foreground}
\begin{scope}
    \clip[use path=\pingu@lowerpingu];
    \coordinate (\pingu@name-wings-right-start) at ([yshift=-.45cm]\pingu@name-wings-side-right);
    \pingu@block[rotate around={42:(\pingu@name-wings-right-start)}]{\pingu@color@right@wing} (\pingu@name-wings-right-start) ellipse [x radius=.225cm, y radius=1.05cm] +(-90:.225cm and 1.05cm) coordinate (\pingu@name-wings-right-tip) +(-90:.175cm and .9cm) coordinate (\pingu@name-wings-right);
\end{scope}\endpgfonlayer}

\pingu@leftwing@add{shock}{%
\pgfonlayer{foreground}
\begin{scope}
    \clip[use path=\pingu@lowerpingu];
    \coordinate (\pingu@name-wings-left-start) at ([yshift=-.8cm]\pingu@name-wings-side-left);
    \pingu@block[rotate around={65:(\pingu@name-wings-left-start)}]{\pingu@color@left@wing} (\pingu@name-wings-left-start) ellipse [x radius=.235cm, y radius=.85cm] +(90:.235cm and .85cm) coordinate (\pingu@name-wings-left-tip) +(90:.185cm and .7cm) coordinate (\pingu@name-wings-left);
\end{scope}\endpgfonlayer}
\pingu@rightwing@add{shock}{%
\pgfonlayer{foreground}
\begin{scope}
    \clip[use path=\pingu@lowerpingu];
    \coordinate (\pingu@name-wings-right-start) at ([yshift=-.8cm]\pingu@name-wings-side-right);
    \pingu@block[rotate around={-65:(\pingu@name-wings-right-start)}]{\pingu@color@right@wing} (\pingu@name-wings-right-start) ellipse [x radius=.235cm, y radius=.85cm] +(90:.235cm and .85cm) coordinate (\pingu@name-wings-right-tip) +(90:.185cm and .7cm) coordinate (\pingu@name-wings-right);
\end{scope}\endpgfonlayer}

%%% Hairstyle %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\pingu@hairstyle@add{normal}{%
\begin{scope}[rounded corners=.008cm]
\pingu@block{\pingu@color@hair@a} ([yshift=-.1cm]\pingu@name-head-top) -- ++(.015cm,0) arc (0:90:\pingu@one@eight{} and .135cm) arc (90:0:.035cm and .075cm);
\pingu@block{\pingu@color@hair@b} ([yshift=-.1cm]\pingu@name-head-top) -- ++(.033cm,0) arc (0:90:\pingu@one@eight{} and .175cm) arc (90:0:.035cm and .1cm);
\pingu@block{\pingu@color@hair@c} ([yshift=-.1cm]\pingu@name-head-top) -- ++(-.033cm,0) arc (180:90:.17cm and .215cm) arc (90:180:.075cm and .18cm);
\pingu@block{\pingu@color@hair@d} ([yshift=-.1cm]\pingu@name-head-top) -- ++(.025cm,0) arc (180:90:\pingu@one@eight{} and .175cm) arc (90:180:.035cm and \pingu@one@eight);
\pingu@block{\pingu@color@hair@e} ([yshift=-.1cm]\pingu@name-head-top) -- ++(.044cm,0) arc (180:90:\pingu@one@eight{} and .135cm) arc (90:180:.035cm and .075cm);
\end{scope}
}

%%% Feet %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\pingu@draw@feet{%
    \coordinate (\pingu@name-foot-right-1) at ([xshift=-.5\pingu@foot@single@h]\pingu@name-foot-right);
    \coordinate (\pingu@name-foot-right-2) at (\pingu@name-foot-right);
    \coordinate (\pingu@name-foot-right-3) at ([xshift= .5\pingu@foot@single@h]\pingu@name-foot-right);
    \pingu@block[rotate around={-25-\basicfeetbend:(\pingu@name-foot-right-1)}]{\pingu@color@foot@right} (\pingu@name-foot-right-1) ellipse [x radius=\pingu@foot@single@w,y radius=\pingu@foot@single@h];
    \pingu@block[rotate around={-\basicfeetbend:(\pingu@name-foot-right-2)}]{\pingu@color@foot@right} (\pingu@name-foot-right-2) ellipse [x radius=\pingu@foot@single@w,y radius=\pingu@foot@single@h];
    \pingu@block[rotate around={25-\basicfeetbend:(\pingu@name-foot-right-3)}]{\pingu@color@foot@right} (\pingu@name-foot-right-3) ellipse [x radius=\pingu@foot@single@w,y radius=\pingu@foot@single@h];

    \coordinate (\pingu@name-foot-left-1) at ([xshift=-.5\pingu@foot@single@h]\pingu@name-foot-left);
    \coordinate (\pingu@name-foot-left-2) at (\pingu@name-foot-left);
    \coordinate (\pingu@name-foot-left-3) at ([xshift= .5\pingu@foot@single@h]\pingu@name-foot-left);
    \pingu@block[rotate around={-25+\basicfeetbend:(\pingu@name-foot-left-1)}]{\pingu@color@foot@left} (\pingu@name-foot-left-1) ellipse [x radius=\pingu@foot@single@w,y radius=\pingu@foot@single@h];
    \pingu@block[rotate around={\basicfeetbend:(\pingu@name-foot-left-2)}]{\pingu@color@foot@left} (\pingu@name-foot-left-2) ellipse [x radius=\pingu@foot@single@w,y radius=\pingu@foot@single@h];
    \pingu@block[rotate around={25+\basicfeetbend:(\pingu@name-foot-left-3)}]{\pingu@color@foot@left} (\pingu@name-foot-left-3) ellipse [x radius=\pingu@foot@single@w,y radius=\pingu@foot@single@h];
}

%%% Bill %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\pingu@bill@add{normal}{%
\pingu@block{\pingu@color@bill}
    (bottom-top-center)++(0,-.005cm-\pingu@outer@off)
    coordinate (\pingu@name-bill)++(-.19cm,0)
    arc (180:360:.19cm and .225cm)
    coordinate[pos=.5] (\pingu@name-bill-bottom)
    to[bend right=.25cm] cycle;
}

%%% Extras %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\pingu@draw@extras@above{%
    \if@pingu@x@strawhat@ \pingu@draw@ea@strawhat \fi
    \if@pingu@x@halo@ \pingu@draw@ea@halo \fi
}

\def\pingu@draw@ea@strawhat{%
\begin{scope}[rotate around={\pingu@x@strawhat@angle:(\pingu@name-head)},shift={(\pingu@name-head)},shift={(\pingu@x@strawhat@xshift,\pingu@x@strawhat@yshift)},scale=\pingu@x@strawhat@scale]
\pingu@block{\pingu@color@strawhat} (.34cm,\z@) ellipse[x radius=.75cm, y radius=.1cm];
\pingu@block{\pingu@color@strawhat} (\z@,.05cm) rectangle (.68cm,.5cm);
\pingu@block{\pingu@color@strawhat} (.34cm,.5cm) ellipse[x radius=.34cm, y radius=.08cm];
\pingu@block{\pingu@color@strawhat} (-.3955cm,.02cm) -- (1.0755cm,.02cm) -- (.68cm,.2cm) -- (0,.2cm) -- cycle;
\pingu@block{\pingu@color@strawhat@ribbon} (.34cm,.2cm) ellipse[x radius=.34cm, y radius=.08cm];
\pingu@block{\pingu@color@strawhat@ribbon} (\z@,.2cm) rectangle (.68cm,.3cm);
\pingu@block{\pingu@color@strawhat} (.34cm,.3cm) ellipse[x radius=.34cm, y radius=.08cm];
\end{scope}
}

\def\pingu@draw@ea@halo{%
    % TODO: dynamic offsets
\pingu@block[even odd rule]{\pingu@color@halo} (\pingu@name-head-top) circle [x radius=\pingu@w@half-.1cm,y radius=.25cm] circle [x radius=\pingu@w@half-.195cm,y radius=.155cm];
}

\let\pingu@create@selection\relax
\let\pingu@create@extra\relax

\endinput