\def\filename{tikzpingus}
\ProvidesPackage{\filename}[2021/04/30 version v1.0 Penguins in TikZ]

\RequirePackage{tikz,etoolbox}
\usetikzlibrary{intersections}

\pgfdeclarelayer{background}\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}


\def\@pingu@color@ #1#2(#3,#4,#5){\definecolor{pingu@#1}{#2}{#3,#4,#5}}
\@pingu@color@{main}RGB(3,14,29)
\@pingu@color@{black}RGB(23,19,19)
\@pingu@color@{white}RGB(248,248,248)
\@pingu@color@{yellow}RGB(252,187,21)
\def\@pingu@none{!hide}

\newlength\pingu@w@half \pingu@w@half=\dimexpr1cm-.125cm/2\relax
\newlength\pingu@side@h@half \pingu@side@h@half=1.3cm
\newlength\pingu@bend \pingu@bend=.125cm
\newlength\pingu@lower@off \pingu@lower@off=.25cm
\newlength\pingu@outer@off \pingu@outer@off=.25cm
\def\basicfeetbend{45}
\newlength\pingu@foot@outer@w \pingu@foot@outer@w=.45cm
\newlength\pingu@foot@outer@h \pingu@foot@outer@h=.25cm

\newlength\pingu@foot@inner@w \pingu@foot@inner@w=.55cm
\newlength\pingu@foot@inner@h \pingu@foot@inner@h=.115cm
\newlength\pingu@foot@offset@w \pingu@foot@offset@w=-.125cm
\def\eyebaseang{38.5}

\def\pingu@csappto#1#2{\expandafter\ifx\csname #1\endcsname\@empty\@namedef{#1}{#2}\else\csappto{#1}{, #2}\fi}

\def\pingu@create@sel@err#1#2{\PackageError{\filename}{There is no '#2' drawer for '#1'. Choose one of '\@nameuse{@pingu@#1@}'}{Or ask the package maintainer :D}}

% #1 name; TODO: refactor
\def\pingu@create@selection#1{%
    \@namedef{@pingu@#1@}{}%
    \long\@namedef{pingu@#1@add}##1##2{\pingu@csappto{@pingu@#1@}{##1}\long\@namedef{@pingu@drawer@#1@##1@}{##2}}
    \@namedef{pingu@#1@select}##1{\ifcsname @pingu@drawer@#1@##1@\endcsname \@namedef{@pingu@drawer@#1@}{\@nameuse{@pingu@drawer@#1@##1@}}\else\pingu@create@sel@err{#1}{##1}\fi}%
    \@nameuse{pingu@#1@add}{none}{}
}

\pingu@create@selection{lefteye}
\pingu@create@selection{righteye}
\pingu@create@selection{leftwing}
\pingu@create@selection{rightwing}

\def\pingu@color#1#2{\@namedef{pingu@color@#1}{#2}}

% TODO: hide
% TODO: other selections
% TODO: update colors to they can change
\tikzset{%
  /pingu/.search also={/tikz,/pgf}, /pingu/.cd,
  name/.code       = \def\pingu@name{#1},
  scale/.code      = \def\pingu@scale{#1},
  % main style
  @block/.style    = {fill=#1}, @pingu/.style = {},
  % feet
  left foot/.code  = \pingu@color{foot@left}{#1},
  right foot/.code = \pingu@color{foot@right}{#1},
  feet/.style      = {left foot={#1},right foot={#1}},
  feet/.default    = pingu@yellow,
  % body
  body main/.code  = \pingu@color{body@main}{#1},
  body head/.code  = \pingu@color{body@head}{#1},
  body/.style      = {body main={#1}, body head={#1}},
  body/.default    = pingu@main,
  % eyes
  left eye/.code   = \pingu@lefteye@select{#1},
  left eye color/.code = \pingu@color{eye@left}{#1},
  left shiny eye color/.code = \pingu@color{eye@shiny@left}{#1},
  right eye/.code  = \pingu@righteye@select{#1},
  right eye color/.code = \pingu@color{eye@right}{#1},
  right shiny eye color/.code = \pingu@color{eye@shiny@right}{#1},
  eyes/.style      = {left eye={#1}, right eye={#1}}, eyes/.default={normal},
  eyes color/.style = {left eye color={#1}, right eye color={#1}},
  eyes color/.default={pingu@black},
  eyes wink/.style = {eyes={wink}, eyes color={#1}},
  eyes wink/.default = {pingu@black},
  shiny eyes color/.style = {left shiny eye color={#1}, right shiny eye color={#1}},
  shiny eyes color/.default={pingu@white},
  % wings
  left wing color/.code = \pingu@color{left@wing}{#1},
  left wing/.code  = \pingu@leftwing@select{#1},
  right wing color/.code = \pingu@color{right@wing}{#1},
  right wing/.code = \pingu@rightwing@select{#1},
  wings/.style     = {left wing={#1}, right wing={#1}}, wings/.default={normal},
  wings grab/.style={wings={grab}, wings color={#1}}, wings wave/.style={wings={wave}, wings color={#1}},
  wings grab/.default=\pingu@color@body@main wings wave/.default=\pingu@color@body@main,
  wings color/.style = {left wing color={#1}, right wing color={#1}},
  wings color/.default = \pingu@color@body@main,
  % hair color TODO: other colors
  hair/.forward to  = /pingu/hairs color,
  hairs color/.code  = \pingu@color{hairs}{#1}, hairs color/.default={\pingu@color@body@main},
  % size
  height/.code     = \setlength{\pingu@side@h@half}{#1},%
  defaults/.style  = {%
    name={pingu}, feet, body, eyes, eyes color, shiny eyes color, wings, wings color, hairs color%
  }
}


\newcommand*\pingu[1][]{\begingroup
\tikzset{/pingu/.cd, defaults, #1}%
\def\lowerpingu{%
    (0,\pingu@outer@off)
    % left side
    to[bend right=\pingu@bend] ++(0,-\pingu@side@h@half-\pingu@outer@off)
    % feety stuff
    arc (180:270:\pingu@foot@outer@w{} and \pingu@foot@outer@h) coordinate (\pingu@name-foot-right)
    arc (270:360:\pingu@foot@inner@w{} and \pingu@foot@inner@h) -- ++(\pingu@foot@offset@w,0)
    arc (180:270:\pingu@foot@inner@w{} and \pingu@foot@inner@h) coordinate (\pingu@name-foot-left)
    arc (270:360:\pingu@foot@outer@w{} and \pingu@foot@outer@h)%
    % right side
    to[bend right=\pingu@bend] ++(0,\pingu@side@h@half+\pingu@outer@off)
    % coordinate
    coordinate[yshift=-\pingu@outer@off] (wings-left)
    %
    -- (0,\pingu@outer@off) coordinate[yshift=-\pingu@outer@off] (wings-right) coordinate[pos=.5,yshift=-\pingu@outer@off] (bottom-top-center) -- cycle%
}
\fill[\pingu@color@body@main] \lowerpingu;

\fill[\pingu@color@body@head] (bottom-top-center) ellipse[x radius=\pingu@w@half, y radius=.9\pingu@w@half];

\coordinate (\pingu@name-head-top) at ([yshift=.9\pingu@w@half]bottom-top-center);

\begin{scope}[rounded corners=.033cm]
\begin{pgfonlayer}{background}
    \fill[\pingu@color@hairs]  ([yshift=-.1cm]\pingu@name-head-top) -- ++(-.033cm,0) arc (180:90:.17cm and .215cm) arc (90:180:.075cm and .18cm);
    \fill[\pingu@color@hairs]  ([yshift=-.1cm]\pingu@name-head-top) -- ++(.025cm,0) arc (180:90:.125cm and .175cm) arc (90:180:.035cm and .125cm);
    \fill[\pingu@color@hairs]  ([yshift=-.1cm]\pingu@name-head-top) -- ++(.033cm,0) arc (0:90:.125cm and .175cm) arc (90:0:.035cm and .1cm);
    \fill[\pingu@color@hairs]  ([yshift=-.1cm]\pingu@name-head-top) -- ++(.015cm,0) arc (0:90:.125cm and .135cm) arc (90:0:.035cm and .075cm);
    \fill[\pingu@color@hairs]  ([yshift=-.1cm]\pingu@name-head-top) -- ++(.044cm,0) arc (180:90:.125cm and .135cm) arc (90:180:.035cm and .075cm);
\end{pgfonlayer}
\end{scope}

\@pingu@drawer@leftwing@
\@pingu@drawer@rightwing@

\coordinate (belly-center) at (\pingu@w@half,-1cm);

\fill[pingu@white,name path=belly] (belly-center)++(-\pingu@w@half+.1cm,\pingu@lower@off) to[bend right=.8\pingu@bend] ++(0,1.05cm-\pingu@side@h@half-\pingu@lower@off) arc (180:270:.4cm and .2cm) arc (270:360:.5cm and .085cm) -- ++(-.125cm,0) arc (180:270:.5cm and .085cm) arc (270:360:.4cm and .2cm) to[bend right=.8\pingu@bend] ++(0,\pingu@side@h@half-1.05cm+\pingu@lower@off) arc (0:180:\pingu@w@half-.1cm and \pingu@w@half-.1cm);

\coordinate (heartp-right) at ([xshift=-.275cm,yshift=.25cm-\pingu@outer@off]bottom-top-center);
\coordinate (heartp-left) at ([xshift=.275cm,yshift=.25cm-\pingu@outer@off]bottom-top-center);
\fill[pingu@white,name path=heartp-r] (heartp-right)++(0,-.025cm) ellipse [x radius=.525cm,y radius=.65cm];
\fill[pingu@white,name path=heartp-l] (heartp-left)++(0,-.025cm) ellipse [x radius=.525cm,y radius=.65cm];

\path[name intersections={of=heartp-l and belly}]
         (intersection-2) coordinate[xshift=.25cm,yshift=-.0665cm] (arm-left);
\path[name intersections={of=heartp-r and belly}]
         (intersection-1) coordinate[xshift=-.25cm,yshift=-.0665cm] (arm-right);

\@pingu@drawer@lefteye@
\@pingu@drawer@righteye@


\fill[pingu@yellow] (bottom-top-center)++(0,-.005cm-\pingu@outer@off) coordinate (\pingu@name-bill)++(-.19cm,0) arc (180:360:.19cm and .225cm) coordinate[pos=.5] (\pingu@name-bill-bottom) to[bend right=.25cm] cycle;
% \node[gray,scale=2] at([yshift=-.125cm]belly-center) {\faStar};

% \begin{scope}
%     \clip\lowerpingu;
% \path[fill,pingu@main,rotate around={-40:(arm-left)}] (arm-left) ellipse [x radius=.195cm, y radius=.925cm];
% \path[fill,pingu@main,rotate around={40:(arm-right)}] (arm-right) ellipse [x radius=.195cm, y radius=.925cm];
% \end{scope}

\begin{scope}[/pingu/@pingu]
    \begin{pgfonlayer}{background}
        \pingu@draw@feet
    \end{pgfonlayer}
\end{scope}
\endgroup
}

\long\def\pingu@path{\@dblarg\pingu@path@}
\def\pingu@path@[#1]#2#3;{\ifdefstring{#2}{\@pingu@none}{}{\path[#1,#2] #3;}}
\long\def\pingu@block{\@dblarg\pingu@block@}
\def\pingu@block@[#1]#2#3;{\ifdefstring{#2}{\@pingu@none}{}{\path[#1,/pingu/@block=#2] #3;}}
% TODO: eye colors

%%% eyes %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
\def\eyeshift{.08cm}
\pingu@lefteye@add{normal}{%
    \pingu@block{\pingu@color@eye@left} ([yshift=0.075cm,xshift=\eyeshift]heartp-left) coordinate (\pingu@name-left-eye) ellipse [x radius=.1225cm, y radius=.1275cm];
}
\pingu@righteye@add{normal}{%
    \pingu@block{\pingu@color@eye@right} ([yshift=0.075cm,xshift=-\eyeshift]heartp-right) coordinate(\pingu@name-right-eye) ellipse [x radius=.1225cm, y radius=.1275cm];
}
\pingu@lefteye@add{shiny}{%
    \pingu@block{\pingu@color@eye@left} ([yshift=0.075cm,xshift=\eyeshift]heartp-left) coordinate(\pingu@name-left-eye) ellipse [x radius=.22cm, y radius=.26cm];
    \pingu@block{\pingu@color@eye@shiny@left} (\pingu@name-left-eye)++(\eyebaseang:.085cm and .10cm) ellipse [x radius=.08cm, y radius=.1cm];
    \pingu@block{\pingu@color@eye@shiny@left} (\pingu@name-left-eye)++(\eyebaseang+180:.12cm and .14cm) ellipse [x radius=.025cm, y radius=.035cm];
}
\pingu@righteye@add{shiny}{%
    \pingu@block{\pingu@color@eye@right} ([yshift=0.075cm,xshift=-\eyeshift]heartp-right) coordinate(\pingu@name-right-eye) ellipse [x radius=.22cm, y radius=.26cm];
    \pingu@block{\pingu@color@eye@shiny@right} (\pingu@name-right-eye)++(\eyebaseang:.085cm and .10cm) ellipse [x radius=.08cm, y radius=.1cm];
    \pingu@block{\pingu@color@eye@shiny@right} (\pingu@name-right-eye)++(\eyebaseang+180:.12cm and .14cm) ellipse [x radius=.025cm, y radius=.035cm];
}

\pingu@lefteye@add{wink}{%
    \coordinate (\pingu@name-left-eye) at ([yshift=.075cm,xshift=\eyeshift]heartp-left);
    \fill[\pingu@color@eye@left, rounded corners=.002cm,rotate around={-4:(\pingu@name-left-eye)}] (\pingu@name-left-eye)++(174:.14cm and .14cm)++(0,-0.065cm) arc (174:6:.14cm and .14cm) arc (-6:-174:.01cm and .008cm) arc (6:174:.12cm and .065cm) arc (-6:-174:.01cm and .008cm) -- cycle;
}

\pingu@righteye@add{wink}{%
    \coordinate (\pingu@name-right-eye) at ([yshift=.075cm,xshift=-\eyeshift]heartp-right);
    \fill[\pingu@color@eye@right, rounded corners=.002cm,rotate around={4:(\pingu@name-right-eye)}] (\pingu@name-right-eye)++(174:.14cm and .14cm)++(0,-0.065cm) arc (174:6:.14cm and .14cm) arc (-6:-174:.01cm and .008cm) arc (6:174:.12cm and .065cm) arc (-6:-174:.01cm and .008cm) -- cycle;
}

%%% Wings %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
\pingu@leftwing@add{normal}{%
\begin{pgfonlayer}{background}
    \coordinate (wings-left-start) at ([yshift=-.7cm]wings-left);
    \path[fill,\pingu@color@left@wing,rotate around={15:(wings-left-start)}] (wings-left-start) ellipse [x radius=.195cm, y radius=.925cm];
\end{pgfonlayer}
}
\pingu@rightwing@add{normal}{%
\begin{pgfonlayer}{background}
    \coordinate (wings-right-start) at ([yshift=-.7cm]wings-right);
    \path[fill,\pingu@color@right@wing,rotate around={-15:(wings-right-start)}] (wings-right-start) ellipse [x radius=.195cm, y radius=.925cm];
\end{pgfonlayer}
}

\pingu@leftwing@add{wave}{%
\begin{pgfonlayer}{background}
    \coordinate (wings-left-start) at ([yshift=-.6cm]wings-left);
    \path[fill,\pingu@color@left@wing,rotate around={-35:(wings-left-start)}] (wings-left-start) ellipse [x radius=.225cm, y radius=.925cm];
\end{pgfonlayer}
}
\pingu@rightwing@add{wave}{%
\begin{pgfonlayer}{background}
    \coordinate (wings-right-start) at ([yshift=-.6cm]wings-right);
    \path[fill,\pingu@color@right@wing,rotate around={35:(wings-right-start)}] (wings-right-start) ellipse [x radius=.225cm, y radius=.925cm];
\end{pgfonlayer}
}
\pingu@leftwing@add{raise}{%
    \coordinate (wings-left-start) at ([yshift=-.6cm]wings-left);
    \path[fill,\pingu@color@left@wing,rotate around={-17:(wings-left-start)}] (wings-left-start) ellipse [x radius=.195cm, y radius=.925cm];
}
\pingu@rightwing@add{raise}{%
    \coordinate (wings-right-start) at ([yshift=-.6cm]wings-right);
    \path[fill,\pingu@color@right@wing,rotate around={17:(wings-right-start)}] (wings-right-start) ellipse [x radius=.195cm, y radius=.925cm];
}

\pingu@leftwing@add{grab}{%
\begin{pgfonlayer}{foreground}
\begin{scope}
    \clip\lowerpingu;
    \coordinate (wings-left-start) at ([yshift=-.45cm]wings-left);
    \path[fill,\pingu@color@left@wing,rotate around={-42:(wings-left-start)}] (wings-left-start) ellipse [x radius=.225cm, y radius=1.15cm];
\end{scope}\end{pgfonlayer}}
\pingu@rightwing@add{grab}{%
\begin{pgfonlayer}{foreground}
\begin{scope}
    \clip\lowerpingu;
    \coordinate (wings-right-start) at ([yshift=-.45cm]wings-right);
    \path[fill,\pingu@color@right@wing,rotate around={42:(wings-right-start)}] (wings-right-start) ellipse [x radius=.225cm, y radius=1.15cm];
\end{scope}\end{pgfonlayer}}

%%% Feet %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
\def\pingu@draw@feet{%
    \coordinate (\pingu@name-foot-right-1) at ([xshift=-.1cm]\pingu@name-foot-right);
    \coordinate (\pingu@name-foot-right-2) at (\pingu@name-foot-right);
    \coordinate (\pingu@name-foot-right-3) at ([xshift= .1cm]\pingu@name-foot-right);
    \fill[\pingu@color@foot@right,rotate around={-25-\basicfeetbend:(\pingu@name-foot-right-1)}] (\pingu@name-foot-right-1) ellipse [x radius=.105cm,y radius=.2cm];
    \fill[\pingu@color@foot@right,rotate around={-\basicfeetbend:(\pingu@name-foot-right-2)}] (\pingu@name-foot-right-2) ellipse [x radius=.105cm,y radius=.2cm];
    \fill[\pingu@color@foot@right,rotate around={25-\basicfeetbend:(\pingu@name-foot-right-3)}] (\pingu@name-foot-right-3) ellipse [x radius=.105cm,y radius=.2cm];

    \coordinate (\pingu@name-foot-left-1) at ([xshift=-.1cm]\pingu@name-foot-left);
    \coordinate (\pingu@name-foot-left-2) at (\pingu@name-foot-left);
    \coordinate (\pingu@name-foot-left-3) at ([xshift= .1cm]\pingu@name-foot-left);
    \fill[\pingu@color@foot@left,rotate around={-25+\basicfeetbend:(\pingu@name-foot-left-1)}] (\pingu@name-foot-left-1) ellipse [x radius=.105cm,y radius=.2cm];
    \fill[\pingu@color@foot@left,rotate around={\basicfeetbend:(\pingu@name-foot-left-2)}] (\pingu@name-foot-left-2) ellipse [x radius=.105cm,y radius=.2cm];
    \fill[\pingu@color@foot@left,rotate around={25+\basicfeetbend:(\pingu@name-foot-left-3)}] (\pingu@name-foot-left-3) ellipse [x radius=.105cm,y radius=.2cm];
}

\endinput