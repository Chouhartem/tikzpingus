\def\filename{tikzpingus}
\ProvidesPackage{\filename}[2021/04/30 version v1.0 Penguins in TikZ]

\newif\ifpengu@setup@glows@
\DeclareOption{glows}{\pengu@setup@glows@true}
\DeclareOption{noglows}{\pengu@setup@glows@false}

\newif\ifpengu@setup@manual@layers@
\DeclareOption{manual-layers}{\pengu@setup@manual@layers@true}
\DeclareOption{nomanual-layers}{\pengu@setup@manual@layers@false}
\ProcessOptions*%

\RequirePackage{tikz}
\usetikzlibrary{intersections,patterns.meta,decorations.pathmorphing,shadings}

\pgfdeclarelayer{background}\pgfdeclarelayer{foreground}\pgfdeclarelayer{middle}
\ifpengu@setup@manual@layers@\else
\pgfsetlayers{background,main,middle,foreground}
\fi

% #region colors
\def\@pingu@color@ #1#2(#3,#4,#5){\definecolor{pingu@#1}{#2}{#3,#4,#5}}
\@pingu@color@{main}RGB(3,14,29)
\@pingu@color@{black}RGB(23,19,19)
\@pingu@color@{silver}RGB(192,192,192)
\@pingu@color@{bronze}RGB(205,127,50)
\@pingu@color@{white}RGB(248,248,248)
\@pingu@color@{yellow}RGB(252,187,21)
\@pingu@color@{lightblue}RGB(174,229,243)
\@pingu@color@{blue}RGB(48,161,247)
\@pingu@color@{green}RGB(129,204,041)
\@pingu@color@{red}RGB(217, 40, 28)
\@pingu@color@{purple}RGB(244,48,93)
\def\@pingu@none{!hide}
% #endregion

% #region lengths and dimens
\newdimen\pingu@one@eight     \pingu@one@eight=.125cm\relax
\newdimen\pingu@w@half        \pingu@w@half=\dimexpr1cm-.5\pingu@one@eight\relax
\newdimen\pingu@side@h@half   \pingu@side@h@half=1.275cm\relax
\newdimen\pingu@bend          \pingu@bend=\pingu@one@eight\relax
\newdimen\pingu@lower@off     \pingu@lower@off=.25cm\relax
\newdimen\pingu@outer@off     \pingu@outer@off=.25cm\relax
\def\basicfeetbend{45}
\newdimen\pingu@foot@outer@w  \pingu@foot@outer@w=4.5mm\relax
\newdimen\pingu@foot@outer@h  \pingu@foot@outer@h=.25cm\relax

\newdimen\pingu@foot@inner@w  \pingu@foot@inner@w=.55cm\relax
\newdimen\pingu@foot@inner@h  \pingu@foot@inner@h=.115cm\relax
\newdimen\pingu@foot@offset@w \pingu@foot@offset@w=-\pingu@one@eight\relax
\newdimen\pingu@foot@single@w \pingu@foot@single@w=.105cm\relax
\newdimen\pingu@foot@single@h \pingu@foot@single@h=2mm\relax
\def\eyebaseang{38.5}
\newdimen\pingu@eye@shift     \pingu@eye@shift=.8mm\relax
\def\pinguanglehl{.93}
\def\pinguanglehr{.07}
% #endregion

% #region selections
\def\pingu@csappto#1#2{\expandafter\ifx\csname #1\endcsname\@empty\@namedef{#1}{#2}\else\expandafter\g@addto@macro\csname #1\endcsname{, #2}\fi}

\def\pingu@create@sel@err#1#2{%
    \PackageError{\filename}{There is no '#2' drawer for '#1'. Choose one of '\@nameuse{@pingu@#1@}'}{Or ask the package maintainer :D}%
}

% #1 name | none default
\def\pingu@create@selection#1#2{%
    \expandafter\let\csname @pingu@#1@\endcsname\@empty
    \expandafter\long\expandafter\def\csname pingu@#1@add\endcsname##1##2{%
        \pingu@csappto{@pingu@#1@}{##1}%
        \expandafter\long\expandafter\def\csname @pingu@drawer@#1@##1@\endcsname{##2}%
    }
    \expandafter\def\csname pingu@#1@select\endcsname##1{%
        \ifcsname @pingu@drawer@#1@##1@\endcsname
            \expandafter\let\csname @pingu@drawer@#1@\expandafter\endcsname\csname @pingu@drawer@#1@##1@\endcsname
            \expandafter\def\csname @pingu@select@#1@\expandafter\endcsname{##1}%
        \else\pingu@create@sel@err{#1}{##1}\fi
    }%
    \csname pingu@#1@add\endcsname{none}{#2}%
}

\long\def\pingu@create@extra#1#2#3{\expandafter\newif\csname if@pingu@x@#1@\endcsname\tikzset{/pingu/.cd,#2,extra defaults/.append style={#3}}}
\def\pingu@set@extra#1#2{\csname @pingu@x@#1@#2\endcsname}

\pingu@create@selection{lefteye}{%
    \path ([yshift=.75mm,xshift=\pingu@eye@shift]\pingu@name-eye-back-left) coordinate (\pingu@name-left-eye);%
}
\pingu@create@selection{righteye}{%
    \path ([yshift=.75mm,xshift=-\pingu@eye@shift]\pingu@name-eye-back-right) coordinate (\pingu@name-right-eye);%
}
\pingu@create@selection{leftwing}{%
    \path ([yshift=-6.5mm]\pingu@name-wings-side-left)
        coordinate (\pingu@name-wing-left-start)
        coordinate (\pingu@name-wing-left-tip)
        coordinate (\pingu@name-wing-left);%
}
\pingu@create@selection{rightwing}{%
    \path ([yshift=-6.5mm]\pingu@name-wings-side-right)
        coordinate (\pingu@name-wing-right-start)
        coordinate (\pingu@name-wing-right-tip)
        coordinate (\pingu@name-wing-right);%
}
\pingu@create@selection{hairstyle}{}
\pingu@create@selection{bill}{%
    \coordinate (\pingu@name-bill-bottom) at (\pingu@name-bill);%
}
\pingu@create@selection{leftfoot}{}
\pingu@create@selection{rightfoot}{}
% #endregion

% #region key setup
\def\pingu@color#1#2{\expandafter\def\csname pingu@color@#1\endcsname{#2}}

% HACK: store scale
\tikzset{/tikz/scale/.append code={\def\pingu@default@scale{#1}}}
\def\pingu@default@scale{1}

\newif\if@pingu@draw@metadots

% TODO: other selections
\tikzset{%
  /pingu/.search also={/tikz,/pgf}, /pingu/.cd,%
  name/.code                    = \def\pingu@name{#1},
  scale/.code                   = \def\pingu@scale{#1},
  meta dots/.forward to         = /pingu/meta-dots,
  meta-dots/.is if              = @pingu@draw@metadots,
  meta-dots/.default            = true,
  @pingu@all/.style             = {},
  @block/.style                 = {/pingu/@pingu@all=#1, fill=#1},
  @draw/.style                  = {/pingu/@pingu@all=#1, cap=round, draw=#1},
  @text/.style                  = {transform shape,text=\pingu@color@body@main},
  @clip even odd rule/.code     = {\pgfseteorule}, % Credit to Andrew Stacey
  @invclip/.style               = {clip,insert path=[/pingu/@clip even odd rule]{[reset cm](-\maxdimen,-\maxdimen)rectangle(\maxdimen,\maxdimen)}},
  @pingu/.style = {}, @pingu@main/.style = {},
  % feet
  left foot color/.code         = \pingu@color{foot@left}{#1},
  left foot/.code               = \pingu@leftfoot@select{#1},
  right foot color/.code        = \pingu@color{foot@right}{#1},
  right foot/.code              = \pingu@rightfoot@select{#1},
  feet/.style                   = {/pingu/left foot={#1}, /pingu/right foot={#1}},
  feet color/.style             = {/pingu/left foot color={#1}, /pingu/right foot color={#1}},
  % body
  body main/.code               = \pingu@color{body@main}{#1},
  body head/.code               = \pingu@color{body@head}{#1},
  body/.style                   = {/pingu/body main={#1}, /pingu/body head={#1}},
  body front/.code              = \pingu@color{body@front}{#1},
  % belly
  belly/.forward to             = /pingu/belly text,
  belly text/.style             = {/pingu/belly raw={\node[/pingu/@text,opacity=.2] {#1};}},
  belly raw/.code               = \def\pingu@belly@raw{#1},
  % eyes
  left eye/.code                = \pingu@lefteye@select{#1},
  left eye color/.code          = \pingu@color{eye@left}{#1},
  left eye second color/.code   = \pingu@color{eye@second@left}{#1},
  right eye/.code               = \pingu@righteye@select{#1},
  right eye color/.code         = \pingu@color{eye@right}{#1},
  right eye second color/.code  = \pingu@color{eye@second@right}{#1},
  eyes/.style                   = {/pingu/left eye={#1}, /pingu/right eye={#1}},
  eyes color/.style             = {/pingu/left eye color={#1}, /pingu/right eye color={#1}},
  second eyes color/.style      = {/pingu/left eye second color={#1}, /pingu/right eye second color={#1}},
  % wings
  left wing color/.code         = \pingu@color{left@wing}{#1},
  left wing/.code               = \pingu@leftwing@select{#1},
  right wing color/.code        = \pingu@color{right@wing}{#1},
  right wing/.code              = \pingu@rightwing@select{#1},
  wings/.style                  = {/pingu/left wing={#1}, /pingu/right wing={#1}},
  wings color/.style            = {/pingu/left wing color={#1},
                                   /pingu/right wing color={#1}},
  % bill
  bill/.code                    = \pingu@bill@select{#1},
  bill color/.code              = \pingu@color{bill}{#1},
  % hair color TODO: other colors
  hair/.forward to              = /pingu/hairs color,
  hairs/.forward to             = /pingu/hairs color,
  hair 1 color/.code            = \pingu@color{hair@a}{#1}, hair 1/.forward to = /pingu/hair 1 color,
  hair 2 color/.code            = \pingu@color{hair@b}{#1}, hair 2/.forward to = /pingu/hair 2 color,
  hair 3 color/.code            = \pingu@color{hair@c}{#1}, hair 3/.forward to = /pingu/hair 3 color,
  hair 4 color/.code            = \pingu@color{hair@d}{#1}, hair 4/.forward to = /pingu/hair 4 color,
  hair 5 color/.code            = \pingu@color{hair@e}{#1}, hair 5/.forward to = /pingu/hair 5 color,
  hairs color/.style            = {/pingu/hair 1 color={#1}, /pingu/hair 2 color={#1}, /pingu/hair 3 color={#1},
                                   /pingu/hair 4 color={#1}, /pingu/hair 5 color={#1}},
  hair style/.forward to        = /pingu/hairstyle,
  hairstyle/.code               = \pingu@hairstyle@select{#1},
  % size
  height/.code                 = \setlength{\pingu@side@h@half}{#1},%
  small height/.forward to     = /pingu/small size, small/.forward to = /pingu/small size,
  small size/.style            = {height=11mm},
  normal height/.forward to    = /pingu/normal size, normal/.forward to = /pingu/normal size,
  normal size/.style           = {height=1.275cm},
  large height/.forward to     = /pingu/large size, large/.forward to = /pingu/large size,
  large size/.style            = {height=15mm},
  defaults/.style               = {%
    name=pingu, feet=normal, feet color=pingu@yellow, body=pingu@main,
    body front=pingu@white,%
    eyes=normal, eyes color=pingu@black, second eyes color=pingu@white,
    bill=normal, bill color=pingu@yellow,
    wings=normal, wings color=\pingu@color@body@main,
    hairstyle=normal, hairs color=\pingu@color@body@main,
    belly raw={}, scale=\pingu@default@scale,extra defaults,user defaults%
  },
  user defaults/.style = {},
  % will be set individually
  extra defaults/.style = {}
}
\def\pingudefaults#1{\tikzset{/pingu/user defaults/.style={#1}}}
\def\pingudefaultsappend#1{\tikzset{/pingu/user defaults/.append style={#1}}}
% #endregion

% #region subenvs
\def\pingu@layer#1[#2]{\pgfonlayer{#1}\scope[/pingu/@pingu,#2]}
\def\endpingu@layer{\endscope\endpgfonlayer}
% #endregion

% #region complete sets and styles
\tikzset{
  pingu line/.style            =  {/pingu/@block/.append style={fill=none,draw=##1!80!black,shade=none,path fading=none}},
  pingu ghost parts/.style     = {/pingu/@pingu@all/.append style={opacity={#1}}},
  pingu ghost parts/.default   = {.5},
  pingu ghost/.style           = {/pingu/@pingu/.append style={opacity=#1,transparency group}},
  pingu ghost/.default         = {.5},
  pingu devil/.style           = {devil horns=#1,eyes devil=#1},
  pingu devil/.default         = pingu@purple,
  % TODO: draw another penguin that is then drawn above with only back
  pingu back/.style            = {/pingu/eyes=none,/pingu/bill=none,/pingu/body front=\pingu@color@body@main,/pingu/@pingu@main/.append style={xshift=2\pingu@w@half,xscale=-1},/pingu/feet back},
}
% #endregion

% #region glows
\ifpengu@setup@glows@
\usetikzlibrary{fadings}%
\tikzfading[name=pingu@halo fade out,inner color=transparent!0,outer color=transparent!100]
\tikzset{/pingu/@glow/.style={path fading={pingu@halo fade out},#1}}
\else
\tikzset{/pingu/@glow/.style={},/pingu/@saber@glow/.style={}}
\fi
% #endregion

% #region core
\long\def\pingu@path{\@dblarg\pingu@path@}
\def\pingu@path@[#1]#2#3;{\protected@edef\@tmp{#2}\ifx\@tmp\@pingu@none\else\path[#1,#2] #3;\fi}
\long\def\pingu@block{\@dblarg\pingu@block@}
\def\pingu@block@[#1]#2#3;{\protected@edef\@tmp{#2}\ifx\@tmp\@pingu@none\else\path[#1,/pingu/@block=#2] #3;\fi}
\long\def\pingu@draw{\@dblarg\pingu@draw@}
\def\pingu@draw@[#1]#2#3;{\protected@edef\@tmp{#2}\ifx\@tmp\@pingu@none\else\path[#1,/pingu/@draw=#2] #3;\fi}

\newcommand*\pingu[1][]{\begingroup
\tikzset{/pingu/.cd, defaults, #1}%
\scope[/pingu/@pingu,/pingu/@pingu@main]
\@pingu@base
\coordinate (\pingu@name-belly-back) at (\pingu@w@half,-1cm);
\coordinate (\pingu@name-belly-center) at (\pingu@w@half,-.68\pingu@side@h@half);
\pingu@block[save path=\pingu@whitepingu]{\pingu@color@body@front} (\pingu@name-belly-back)++(-\pingu@w@half+1mm,\pingu@lower@off) to[bend right=.8\pingu@bend] ++(0,1.05cm-\pingu@side@h@half-\pingu@lower@off) arc (180:270:4mm and 2mm) arc (270:331:5mm and .85mm) arc (207:270:5mm and .85mm) arc (270:360:4mm and 2mm) to[bend right=.8\pingu@bend] ++(0,\pingu@side@h@half-1.05cm+\pingu@lower@off) arc (0:180:\pingu@w@half-.96mm and \pingu@w@half-1mm) -- cycle;

\coordinate (\pingu@name-eye-back-right) at ([xshift=-.275cm,yshift=.25cm-\pingu@outer@off]\pingu@name-head-center);
\coordinate (\pingu@name-eye-back-left) at ([xshift=.275cm,yshift=.25cm-\pingu@outer@off]\pingu@name-head-center);

\coordinate (\pingu@name-head-back-con-right) at ([xshift=-.525cm*.74,yshift=-.65cm*.719]\pingu@name-eye-back-right);
\coordinate (\pingu@name-head-back-con-left) at ([xshift=.525cm*.74,yshift=-.65cm*.719]\pingu@name-eye-back-left);

\pingu@block{\pingu@color@body@front} (\pingu@name-eye-back-right)++(0,-.25mm) ellipse [x radius=.525cm,y radius=.65cm];
\pingu@block{\pingu@color@body@front} (\pingu@name-eye-back-left)++(0,-.25mm) ellipse [x radius=.525cm,y radius=.65cm];

\path (\pingu@name-head-center)++(0,-.05mm-\pingu@outer@off) coordinate (\pingu@name-bill);

\scope[shift=(\pingu@name-belly-center)]
\clip[use path=\pingu@whitepingu]; \pingu@belly@raw
\endscope
\coordinate (\pingu@name-head) at (\pingu@w@half,.7375cm);
% TODO: more lengths

\@pingu@drawer@lefteye@
\@pingu@drawer@righteye@

\pingu@layer{background}[]\pingu@draw@clothing@behind\endpingu@layer

\pingu@draw@extras@below

\@pingu@drawer@leftwing@
\@pingu@drawer@rightwing@

\@pingu@drawer@bill@
\@pingu@drawer@hairstyle@
\pingu@layer{background}[]
\@pingu@drawer@leftfoot@
\@pingu@drawer@rightfoot@
\endpingu@layer

\pingu@draw@extras@above
\pingu@draw@wing@items

\pingu@draw@clothing@main
\endscope
\if@pingu@draw@metadots
\@pingu@draw@dots
\fi
\endgroup
\ifpengu@setup@manual@layers@\pgfsetlayers{background,main,middle,foreground}\fi}
% Note: to be used in clippies
\def\pingu@path@lowerpingu{(0,\pingu@outer@off)
% left side
to[bend right=\pingu@bend] ++(0,-\pingu@side@h@half-\pingu@outer@off)
% feety stuff
arc (180:270:\pingu@foot@outer@w{} and \pingu@foot@outer@h)
arc (270:332:\pingu@foot@inner@w{} and \pingu@foot@inner@h)
arc (208:270:\pingu@foot@inner@w{} and \pingu@foot@inner@h)
arc (270:360:\pingu@foot@outer@w{} and \pingu@foot@outer@h)%
% right side
to[bend right=\pingu@bend] ++(0,\pingu@side@h@half+\pingu@outer@off)
arc(0:180:\pingu@w@half{} and .9\pingu@w@half) -- cycle}% arc clip to secure wings
\def\pingu@path@upperpingu{(\pingu@name-head-center) ellipse [x radius=\pingu@w@half, y radius=.9\pingu@w@half]}
\def\@pingu@base{%
    \pingu@block[save path=\pingu@lowerpingu]{\pingu@color@body@main} (0,\pingu@outer@off)
        % left side
        to[bend right=\pingu@bend] coordinate[pos=.775] (\pingu@name-waist-right) ++(0,-\pingu@side@h@half-\pingu@outer@off)
        % feety stuff
        arc (180:270:\pingu@foot@outer@w{} and \pingu@foot@outer@h) coordinate (\pingu@name-foot-right)
        arc (270:332:\pingu@foot@inner@w{} and \pingu@foot@inner@h)
        coordinate (\pingu@name-bottom-center)
        arc (208:270:\pingu@foot@inner@w{} and \pingu@foot@inner@h) coordinate (\pingu@name-foot-left)
        arc (270:360:\pingu@foot@outer@w{} and \pingu@foot@outer@h)%
        % right side
        to[bend right=\pingu@bend] coordinate[pos=.225] (\pingu@name-waist-left) ++(0,\pingu@side@h@half+\pingu@outer@off)
        % coordinate
        coordinate (\pingu@name-wings-side-left)
        -- (0,\pingu@outer@off) coordinate (\pingu@name-wings-side-right) coordinate[pos=.5] (\pingu@name-head-center) -- cycle;

    % TODO: store widths and height of head and use for e.g. devil
    \pingu@block[save path=\pingu@upperpingu]{\pingu@color@body@head} (\pingu@name-head-center)
        ++(0,.9\pingu@w@half) coordinate (\pingu@name-head-top)
        arc(90:450:\pingu@w@half{} and .9\pingu@w@half)
        coordinate[pos=\pinguanglehr] (\pingu@name-head-right)
        coordinate[pos=\pinguanglehl] (\pingu@name-head-left);
}
% #endregion

% #region eyes
% name core | left | right
\long\def\@pingu@eyes@s#1#2#3{\@ifnextchar[{\@pingu@eyes@s@{#1}{#2}{#3}}{\@pingu@eyes@s@{#1}{#2}{#3}[pingu@black]}}
\long\def\@pingu@eyes@s@#1#2#3[#4]{%
    \tikzset{%
        /pingu/left eye #1/.style   = {/pingu/left eye={#1}, /pingu/left eye color={##1}},%
        /pingu/left eye #1/.default = {#4},%
        /pingu/right eye #1/.style   = {/pingu/right eye={#1}, /pingu/right eye color={##1}},%
        /pingu/right eye #1/.default = {#4},%
        /pingu/eyes #1/.style   = {/pingu/eyes={#1}, /pingu/eyes color={##1}},%
        /pingu/eyes #1/.default = {#4}%
    }%
    \pingu@lefteye@add{#1}{#2}\pingu@righteye@add{#1}{#3}%
}

\@pingu@eyes@s{normal}{%
    \pingu@block{\pingu@color@eye@left} ([yshift=.75mm,xshift=\pingu@eye@shift]\pingu@name-eye-back-left) coordinate (\pingu@name-left-eye) ellipse [x radius=.1225cm, y radius=.1275cm];
}{%
    \pingu@block{\pingu@color@eye@right} ([yshift=.75mm,xshift=-\pingu@eye@shift]\pingu@name-eye-back-right) coordinate(\pingu@name-right-eye) ellipse [x radius=.1225cm, y radius=.1275cm];
}

\@pingu@eyes@s{shiny}{%
    \pingu@block{\pingu@color@eye@left} ([yshift=.75mm,xshift=\pingu@eye@shift]\pingu@name-eye-back-left) coordinate(\pingu@name-left-eye) ellipse [x radius=.22cm, y radius=.26cm];
    \pingu@block{\pingu@color@eye@second@left} (\pingu@name-left-eye)++(\eyebaseang:.85mm and 1mm) ellipse [x radius=.8mm, y radius=1mm];
    \pingu@block{\pingu@color@eye@second@left} (\pingu@name-left-eye)++(\eyebaseang+180:.12cm and .14cm) ellipse [x radius=.25mm, y radius=.35mm];
}{%
    \pingu@block{\pingu@color@eye@right} ([yshift=.75mm,xshift=-\pingu@eye@shift]\pingu@name-eye-back-right) coordinate(\pingu@name-right-eye) ellipse [x radius=.22cm, y radius=.26cm];
    \pingu@block{\pingu@color@eye@second@right} (\pingu@name-right-eye)++(\eyebaseang:.85mm and 1mm) ellipse [x radius=.08cm, y radius=1mm];
    \pingu@block{\pingu@color@eye@second@right} (\pingu@name-right-eye)++(\eyebaseang+180:.12cm and .14cm) ellipse [x radius=.25mm, y radius=.35mm];
}

\@pingu@eyes@s{wink}{%
    \coordinate (\pingu@name-left-eye) at ([yshift=.75mm,xshift=\pingu@eye@shift]\pingu@name-eye-back-left);
    \pingu@block[rounded corners=.002cm,rotate around={-4:(\pingu@name-left-eye)}]{\pingu@color@eye@left} (\pingu@name-left-eye)++(174:.14cm and .14cm)++(0,-.065cm) arc (174:6:.14cm and .14cm) arc (-6:-174:.1mm and .08mm) arc (6:174:.12cm and .065cm) arc (-6:-174:.1mm and .08mm) -- cycle;
}{%
    \coordinate (\pingu@name-right-eye) at ([yshift=.75mm,xshift=-\pingu@eye@shift]\pingu@name-eye-back-right);
    \pingu@block[rounded corners=.002cm,rotate around={4:(\pingu@name-right-eye)}]{\pingu@color@eye@right} (\pingu@name-right-eye)++(174:.14cm and .14cm)++(0,-.065cm) arc (174:6:.14cm and .14cm) arc (-6:-174:.1mm and .08mm) arc (6:174:.12cm and .065cm) arc (-6:-174:.1mm and .08mm) -- cycle;
}

\@pingu@eyes@s{shock}{%
    \pingu@block{\pingu@color@eye@left} ([yshift=.75mm,xshift=\pingu@eye@shift]\pingu@name-eye-back-left) coordinate (\pingu@name-left-eye) ellipse [x radius=.1535cm, y radius=.1575cm];
    \pingu@block{\pingu@color@eye@second@left} ([yshift=.75mm,xshift=\pingu@eye@shift]\pingu@name-eye-back-left) coordinate (\pingu@name-left-eye) ellipse [x radius=.1325cm, y radius=.1375cm];
}{%
    \pingu@block{\pingu@color@eye@right} ([yshift=.75mm,xshift=-\pingu@eye@shift]\pingu@name-eye-back-right) coordinate(\pingu@name-right-eye) ellipse [x radius=.1535cm, y radius=.1575cm];
    \pingu@block{\pingu@color@eye@second@right} ([yshift=.75mm,xshift=-\pingu@eye@shift]\pingu@name-eye-back-right) coordinate(\pingu@name-right-eye) ellipse [x radius=.1325cm, y radius=.1375cm];
}

\@pingu@eyes@s{angry}{%
    \path (\pingu@name-eye-back-left)++(\pingu@eye@shift,.75mm) coordinate (\pingu@name-left-eye);
    \pingu@block{\pingu@color@eye@left} (\pingu@name-left-eye) ellipse [x radius=.1225cm, y radius=.1275cm];
    \pingu@block{\pingu@color@body@front} (\pingu@name-left-eye) ++(120:.1225cm and .1275cm) ellipse [x radius=1.5mm,y radius=.5mm];
}{%
    \path (\pingu@name-eye-back-right)++(-\pingu@eye@shift,.75mm) coordinate (\pingu@name-right-eye);
    \pingu@block{\pingu@color@eye@right} (\pingu@name-right-eye) ellipse [x radius=.1225cm, y radius=.1275cm];
    \pingu@block{\pingu@color@body@front} (\pingu@name-right-eye) ++(60:.1225cm and .1275cm) ellipse [x radius=1.5mm,y radius=.5mm];
}

\@pingu@eyes@s{devil}{%
    \pingu@block{pingu@black} ([yshift=.75mm,xshift=\pingu@eye@shift]\pingu@name-eye-back-left) coordinate (\pingu@name-left-eye) ellipse [x radius=.1535cm, y radius=.1575cm];
    \pingu@block{\pingu@color@eye@second@left} ([yshift=.75mm,xshift=\pingu@eye@shift]\pingu@name-eye-back-left) coordinate (\pingu@name-left-eye) ellipse [x radius=.1325cm, y radius=.1375cm];
    \fill[\pingu@color@eye@left,/pingu/@glow] (\pingu@name-left-eye) circle [radius=1.325mm];
    \pingu@block[fill opacity=.66]{\pingu@color@eye@left} (\pingu@name-left-eye)++(0,.36) to[bend right=58] ++(.36,-.36) to[bend right=58] ++(-.36,-.36) to[bend right=58] ++(-.36,.36) to[bend right=58] cycle;
    \fill[/pingu/@glow,fill=\pingu@color@eye@left!20!pingu@yellow!15!pingu@white] (\pingu@name-left-eye)++(0,.10) to[bend right=60] ++(.10,-.10) to[bend right=60] ++(-.10,-.10) to[bend right=60] ++(-.10,.10) to[bend right=60] cycle;
    \fill[\pingu@color@eye@left!20!pingu@yellow!7!pingu@white] (\pingu@name-left-eye) circle [radius=.5pt]; %
    \pingu@block{pingu@white} (\pingu@name-left-eye) circle [radius=.15pt];
}{%
    \pingu@block{pingu@black} ([yshift=.75mm,xshift=-\pingu@eye@shift]\pingu@name-eye-back-right) coordinate (\pingu@name-right-eye) ellipse [x radius=.1535cm, y radius=.1575cm];
    \pingu@block{\pingu@color@eye@second@right} ([yshift=.75mm,xshift=-\pingu@eye@shift]\pingu@name-eye-back-right) coordinate (\pingu@name-right-eye) ellipse [x radius=.1325cm, y radius=.1375cm];
    \fill[\pingu@color@eye@right,/pingu/@glow] (\pingu@name-right-eye) circle [radius=1.325mm];
    \pingu@block[fill opacity=.66]{\pingu@color@eye@right} (\pingu@name-right-eye)++(0,.36) to[bend right=58] ++(.36,-.36) to[bend right=58] ++(-.36,-.36) to[bend right=58] ++(-.36,.36) to[bend right=58] cycle;
    \fill[/pingu/@glow,fill=\pingu@color@eye@right!20!pingu@yellow!15!pingu@white] (\pingu@name-right-eye)++(0,.10) to[bend right=60] ++(.10,-.10) to[bend right=60] ++(-.10,-.10) to[bend right=60] ++(-.10,.10) to[bend right=60] cycle;
    \fill[\pingu@color@eye@right!20!pingu@yellow!7!pingu@white] (\pingu@name-right-eye) circle [radius=.5pt]; %
    \pingu@block{pingu@white} (\pingu@name-right-eye) circle [radius=.15pt];
}[pingu@purple]
\let\@pingu@eyes@s\relax
% #endregion

% #region wings
% every wing has to define 1) a base element angle and 2) a marker if before or after the wing
\let\pingu@wi@above\iftrue
\let\pingu@wi@below\iffalse
% name core | left | right | above: \iftrue | angle
\long\def\@pingu@wings@s#1#2#3#4#5{%
    \tikzset{%
        /pingu/left wing #1/.style   = {/pingu/left wing={#1}, /pingu/left wing color={##1}},%
        /pingu/left wing #1/.default = \pingu@color@body@main,%
        /pingu/right wing #1/.style   = {/pingu/right wing={#1}, /pingu/right wing color={##1}},%
        /pingu/right wing #1/.default = \pingu@color@body@main,%
        /pingu/wings #1/.style   = {/pingu/wings={#1}, /pingu/wings color={##1}},%
        /pingu/wings #1/.default = \pingu@color@body@main%
    }%
    \expandafter\def\csname @pingu@wing@str@#1@\endcsname{#1}%
    \pingu@leftwing@add{#1}{#2}\pingu@rightwing@add{#1}{#3}%
    \expandafter\let\csname @pingu@wingitem@#1@\endcsname#4\relax
    \expandafter\def\csname @pingu@wingangle@#1@\endcsname{#5}% TODO: for left and right
}
\let\@pingu@wingitem@none@\pingu@wi@above
\def\@pingu@wingangle@none@\endcsname{90}
\@pingu@wings@s{normal}{%
    \coordinate (\pingu@name-wing-left-start) at ([yshift=-6.5mm]\pingu@name-wings-side-left);
\scope[xshift=-\p@] % shift to avoid rounding errors in pdf viewers
    \pgfinterruptboundingbox
    \path[/pingu/@invclip] \pingu@path@lowerpingu;
    \endpgfinterruptboundingbox
    \pingu@block[rotate around={15:(\pingu@name-wing-left-start)}]{\pingu@color@left@wing} (\pingu@name-wing-left-start) ellipse [x radius=.195cm, y radius=9mm] +(-90:.195cm and 9mm) coordinate (\pingu@name-wing-left-tip) +(-90:.145cm and .75cm) coordinate (\pingu@name-wing-left);
\endscope}{%
\coordinate (\pingu@name-wing-right-start) at ([yshift=-6.5mm]\pingu@name-wings-side-right);
\scope[xshift=\p@] % shift to avoid rounding errors in pdf viewers
    \pgfinterruptboundingbox
    \path[/pingu/@invclip] \pingu@path@lowerpingu;
    \endpgfinterruptboundingbox
    \pingu@block[rotate around={-15:(\pingu@name-wing-right-start)}]{\pingu@color@right@wing} (\pingu@name-wing-right-start) ellipse [x radius=.195cm, y radius=9mm] +(-90:.195cm and 9mm) coordinate (\pingu@name-wing-right-tip) +(-90:.145cm and .75cm) coordinate (\pingu@name-wing-right);
\endscope}{\pingu@wi@above}{-5}

\@pingu@wings@s{wave}{%
    \coordinate (\pingu@name-wing-left-start) at ([yshift=-5.85mm]\pingu@name-wings-side-left);
    \scope[xshift=-\p@] % shift to avoid rounding errors in pdf viewers
    \pgfinterruptboundingbox
    \path[/pingu/@invclip] \pingu@path@lowerpingu;
    \endpgfinterruptboundingbox
    \pingu@block[rotate around={-39:(\pingu@name-wing-left-start)}]{\pingu@color@left@wing} (\pingu@name-wing-left-start) ellipse [x radius=2.2mm, y radius=9.35mm] +(90:.22cm and .935cm)  coordinate (\pingu@name-wing-left-tip) +(150:.22cm and .935cm) coordinate (\pingu@name-wing-left-cap-up) +(-3:.22cm and .935cm) coordinate (\pingu@name-wing-left-cap-down) +(90:.175cm and .75cm) coordinate (\pingu@name-wing-left);
    \pingu@block{\pingu@color@left@wing} (\pingu@name-wing-left-start)++(.03mm,4.6mm) to[out=-80,in=220] (\pingu@name-wing-left-cap-up) -- (\pingu@name-wing-left-start) -- cycle;
    \pingu@block{\pingu@color@left@wing} (\pingu@name-wing-left-start)++(.085mm,-4.4mm) to[out=80,in=-131] (\pingu@name-wing-left-cap-down) -- (\pingu@name-wing-left-start) -- cycle;
    \endscope}{%
    \coordinate (\pingu@name-wing-right-start) at ([yshift=-5.85mm]\pingu@name-wings-side-right);
\scope[xshift=\p@] % shift to avoid rounding errors in pdf viewers
    \pgfinterruptboundingbox
    \path[/pingu/@invclip] \pingu@path@lowerpingu;
    \endpgfinterruptboundingbox
    \pingu@block[rotate around={39:(\pingu@name-wing-right-start)}]{\pingu@color@right@wing} (\pingu@name-wing-right-start) ellipse [x radius=.22cm, y radius=.935cm] +(90:.22cm and .935cm) coordinate (\pingu@name-wing-right-tip) +(30:.22cm and .935cm) coordinate (\pingu@name-wing-right-cap-up) +(177:.22cm and .935cm) coordinate (\pingu@name-wing-right-cap-down) +(90:.175cm and .775cm) coordinate (\pingu@name-wing-right);
    \pingu@block{\pingu@color@right@wing} (\pingu@name-wing-right-start)++(-.03mm,4.6mm) to[out=-100,in=-45] (\pingu@name-wing-right-cap-up) -- (\pingu@name-wing-right-start) -- cycle;
    \pingu@block{\pingu@color@right@wing} (\pingu@name-wing-right-start)++(-.1mm,-4.4mm) to[out=100,in=-50] (\pingu@name-wing-right-cap-down) -- (\pingu@name-wing-right-start) -- cycle;
\endscope}{\pingu@wi@above}{-10}

\@pingu@wings@s{raise}{%
\coordinate (\pingu@name-wing-left-start) at ([yshift=-6.25mm]\pingu@name-wings-side-left);
\scope[xshift=-\p@] % shift to avoid rounding errors in pdf viewers
\pgfinterruptboundingbox
\path[/pingu/@invclip] \pingu@path@lowerpingu;
\endpgfinterruptboundingbox
    \pingu@block[rotate around={-17:(\pingu@name-wing-left-start)}]{\pingu@color@left@wing} (\pingu@name-wing-left-start) ellipse [x radius=.195cm, y radius=.925cm] +(90:.195cm and .925cm) coordinate (\pingu@name-wing-left-tip) +(90:.145cm and .775cm) coordinate (\pingu@name-wing-left);
\endscope}{%
\scope[xshift=\p@] % shift to avoid rounding errors in pdf viewers
    \pgfinterruptboundingbox
    \path[/pingu/@invclip] \pingu@path@lowerpingu;
    \endpgfinterruptboundingbox
    \coordinate (\pingu@name-wing-right-start) at ([yshift=-6.25mm]\pingu@name-wings-side-right);
    \pingu@block[rotate around={17:(\pingu@name-wing-right-start)}]{\pingu@color@right@wing} (\pingu@name-wing-right-start) ellipse [x radius=.195cm, y radius=.925cm] +(90:.195cm and .925cm) coordinate (\pingu@name-wing-right-tip) +(90:.145cm and .775cm) coordinate (\pingu@name-wing-right);
\endscope}%
{\pingu@wi@above}{0}

\@pingu@wings@s{grab}{%
\pingu@layer{foreground}[]
    \clip[use path=\pingu@lowerpingu];
    \coordinate (\pingu@name-wing-left-start) at ([yshift=-4.5mm]\pingu@name-wings-side-left);
    \pingu@block[rotate around={-42:(\pingu@name-wing-left-start)}]{\pingu@color@left@wing} (\pingu@name-wing-left-start) ellipse [x radius=.225cm, y radius=1.05cm] +(-90:.225cm and 1.05cm) coordinate (\pingu@name-wing-left-tip) +(-90:.175cm and 9mm) coordinate (\pingu@name-wing-left);
\endpingu@layer}{%
\pingu@layer{foreground}[]
    \clip[use path=\pingu@lowerpingu];
    \coordinate (\pingu@name-wing-right-start) at ([yshift=-4.5mm]\pingu@name-wings-side-right);
    \pingu@block[rotate around={42:(\pingu@name-wing-right-start)}]{\pingu@color@right@wing} (\pingu@name-wing-right-start) ellipse [x radius=.225cm, y radius=1.05cm] +(-90:.225cm and 1.05cm) coordinate (\pingu@name-wing-right-tip) +(-90:.175cm and 9mm) coordinate (\pingu@name-wing-right);
\endpingu@layer}%
{\pingu@wi@below}{12}

\@pingu@wings@s{shock}{%
\pingu@layer{foreground}[]
    \clip[use path=\pingu@lowerpingu];
    \coordinate (\pingu@name-wing-left-start) at ([yshift=-6.5mm]\pingu@name-wings-side-left);
    \pingu@block[rotate around={65:(\pingu@name-wing-left-start)}]{\pingu@color@left@wing} (\pingu@name-wing-left-start) ellipse [x radius=.235cm, y radius=.85cm] +(90:.235cm and .85cm) coordinate (\pingu@name-wing-left-tip) +(90:.185cm and .7cm) coordinate (\pingu@name-wing-left);
\endpingu@layer}{%
\pingu@layer{foreground}[]
    \clip[use path=\pingu@lowerpingu];
    \coordinate (\pingu@name-wing-right-start) at ([yshift=-6.5mm]\pingu@name-wings-side-right);
    \pingu@block[rotate around={-65:(\pingu@name-wing-right-start)}]{\pingu@color@right@wing} (\pingu@name-wing-right-start) ellipse [x radius=.235cm, y radius=.85cm] +(90:.235cm and .85cm) coordinate (\pingu@name-wing-right-tip) +(90:.185cm and .7cm) coordinate (\pingu@name-wing-right);
\endpingu@layer}%
{\pingu@wi@below}{-180}

\@pingu@wings@s{hug}{%
\coordinate (\pingu@name-wing-left-start) at ([yshift=-6.25mm]\pingu@name-wings-side-left);
\scope[xshift=-\p@] % shift to avoid rounding errors in pdf viewers
\pgfinterruptboundingbox
\path[/pingu/@invclip] \pingu@path@lowerpingu;
\endpgfinterruptboundingbox
\pingu@block[rotate around={-128:(\pingu@name-wing-left-start)}]{\pingu@color@left@wing} (\pingu@name-wing-left-start) ellipse [x radius=.235cm, y radius=.925cm] +(90:.235cm and .935cm) coordinate (\pingu@name-wing-left-tip) +(175:.235cm and .935cm) coordinate (\pingu@name-wing-left-cap-up) +(22:.235cm and .935cm) coordinate (\pingu@name-wing-left-cap-down) +(90:.175cm and .775cm) coordinate (\pingu@name-wing-left);
\pingu@block{\pingu@color@left@wing} (\pingu@name-wing-left-start)++(.03mm,4.6mm) to[out=-80,in=140] (\pingu@name-wing-left-cap-up) -- (\pingu@name-wing-left-start) -- cycle;
\pingu@block{\pingu@color@left@wing} (\pingu@name-wing-left-start)++(.085mm,-4.4mm) to[out=82,in=155] (\pingu@name-wing-left-cap-down) -- (\pingu@name-wing-left-start) -- cycle;
\endscope}{%
\coordinate (\pingu@name-wing-right-start) at ([yshift=-6.25mm]\pingu@name-wings-side-right);
\scope[xshift=\p@] % shift to avoid rounding errors in pdf viewers
\pgfinterruptboundingbox
\path[/pingu/@invclip] \pingu@path@lowerpingu;
\endpgfinterruptboundingbox
\pingu@block[rotate around={128:(\pingu@name-wing-right-start)}]{\pingu@color@right@wing} (\pingu@name-wing-right-start) ellipse [x radius=.235cm, y radius=.935cm] +(90:.235cm and .935cm) coordinate (\pingu@name-wing-right-tip) +(5:.235cm and .935cm) coordinate (\pingu@name-wing-right-cap-up) +(160:.235cm and .935cm) coordinate (\pingu@name-wing-right-cap-down) +(90:.175cm and .775cm) coordinate (\pingu@name-wing-right);
\pingu@block{\pingu@color@right@wing} (\pingu@name-wing-right-start)++(-.03mm,4.6mm) to[out=-100,in=40] (\pingu@name-wing-right-cap-up) -- (\pingu@name-wing-right-start) -- cycle;
\pingu@block{\pingu@color@right@wing} (\pingu@name-wing-right-start)++(-.085mm,-4.4mm) to[out=92,in=20] (\pingu@name-wing-right-cap-down) -- (\pingu@name-wing-right-start) -- cycle;
\endscope}{\pingu@wi@above}{-30}
\let\@pingu@wings@s\relax
% #endregion

% #region hairstyle
\pingu@hairstyle@add{normal}{%
\scope\pgfinterruptboundingbox
\clip[/pingu/@invclip] (\pingu@name-head-center) ellipse [x radius=\pingu@w@half, y radius=.9\pingu@w@half-.0165mm];
\endpgfinterruptboundingbox
\scope[rounded corners=.08mm]
\pingu@block{\pingu@color@hair@a} ([yshift=-1mm]\pingu@name-head-top) -- ++(.15mm,0) arc (0:90:\pingu@one@eight{} and .135cm) arc (90:0:.35mm and .75mm);
\pingu@block{\pingu@color@hair@b} ([yshift=-1mm]\pingu@name-head-top) -- ++(.33mm,0) arc (0:90:\pingu@one@eight{} and .175cm) arc (90:0:.35mm and 1mm);
\pingu@block{\pingu@color@hair@c} ([yshift=-1mm]\pingu@name-head-top) -- ++(-.33mm,0) arc (180:90:.17cm and .215cm) arc (90:180:.75mm and .18cm);
\pingu@block{\pingu@color@hair@d} ([yshift=-1mm]\pingu@name-head-top) -- ++(.25mm,0) arc (180:90:\pingu@one@eight{} and .175cm) arc (90:180:.35mm and \pingu@one@eight);
\pingu@block{\pingu@color@hair@e} ([yshift=-1mm]\pingu@name-head-top) -- ++(.44mm,0) arc (180:90:\pingu@one@eight{} and .135cm) arc (90:180:.35mm and .75mm);
\endscope\endscope}
% #endregion

% #region feet
\long\def\@pingu@feet@s#1#2#3{\@ifnextchar[{\@pingu@feet@s@{#1}{#2}{#3}}{\@pingu@feet@s@{#1}{#2}{#3}[pingu@yellow]}}
\long\def\@pingu@feet@s@#1#2#3[#4]{%
    \tikzset{%
        /pingu/left foot #1/.style    = {/pingu/left foot={#1}, /pingu/left foot color={##1}},%
        /pingu/left foot #1/.default  = {#4},%
        /pingu/right foot #1/.style   = {/pingu/right foot={#1}, /pingu/right foot color={##1}},%
        /pingu/right foot #1/.default = {#4},%
        /pingu/feet #1/.style         = {/pingu/feet={#1}, /pingu/feet color={##1}},%
        /pingu/feet #1/.default       = {#4}%
    }%
    \pingu@leftfoot@add{#1}{#2}\pingu@rightfoot@add{#1}{#3}%
}

\@pingu@feet@s{normal}{%
    \coordinate (@tmp) at ([xshift=-.5\pingu@foot@single@h]\pingu@name-foot-left);
    \pingu@block[rotate around={-25+\basicfeetbend:(@tmp)}]{\pingu@color@foot@left} (@tmp) ellipse [x radius=\pingu@foot@single@w,y radius=\pingu@foot@single@h];
    \pingu@block[rotate around={\basicfeetbend:(\pingu@name-foot-left)}]{\pingu@color@foot@left} (\pingu@name-foot-left) ellipse [x radius=\pingu@foot@single@w,y radius=\pingu@foot@single@h];
    \coordinate (@tmp) at ([xshift= .5\pingu@foot@single@h]\pingu@name-foot-left);
    \pingu@block[rotate around={25+\basicfeetbend:(@tmp)}]{\pingu@color@foot@left} (@tmp) ellipse [x radius=\pingu@foot@single@w,y radius=\pingu@foot@single@h];
}{%
    \coordinate (@tmp) at ([xshift=-.5\pingu@foot@single@h]\pingu@name-foot-right);
    \pingu@block[rotate around={-25-\basicfeetbend:(@tmp)}]{\pingu@color@foot@right} (@tmp) ellipse [x radius=\pingu@foot@single@w,y radius=\pingu@foot@single@h];
    \pingu@block[rotate around={-\basicfeetbend:(\pingu@name-foot-right)}]{\pingu@color@foot@right} (\pingu@name-foot-right) ellipse [x radius=\pingu@foot@single@w,y radius=\pingu@foot@single@h];
    \coordinate (@tmp) at ([xshift= .5\pingu@foot@single@h]\pingu@name-foot-right);
    \pingu@block[rotate around={25-\basicfeetbend:(@tmp)}]{\pingu@color@foot@right} (@tmp) ellipse [x radius=\pingu@foot@single@w,y radius=\pingu@foot@single@h];
}

\@pingu@feet@s{simple}{%
    \pingu@block[rotate around={-\basicfeetbend:(\pingu@name-foot-left)}]{\pingu@color@foot@left} (\pingu@name-foot-left) ellipse [x radius=2.66\pingu@foot@single@w,y radius=\pingu@foot@single@h];
}{%
    \pingu@block[rotate around={\basicfeetbend:(\pingu@name-foot-right)}]{\pingu@color@foot@right} (\pingu@name-foot-right) ellipse [x radius=2.66\pingu@foot@single@w,y radius=\pingu@foot@single@h];
}


\@pingu@feet@s{back}{%
    \pingu@block{\pingu@color@foot@left} ([yshift=.2\pingu@foot@single@h]\pingu@name-foot-left) ellipse [x radius=2.5\pingu@foot@single@w,y radius=.5\pingu@foot@single@h];
}{%
    \pingu@block{\pingu@color@foot@right} ([yshift=.2\pingu@foot@single@h]\pingu@name-foot-right) ellipse [x radius=2.5\pingu@foot@single@w,y radius=.5\pingu@foot@single@h];
}
% #endregion

% #region bill
% name core | main
\long\def\@pingu@bill@s#1#2{%
    \tikzset{%
        /pingu/bill #1/.style   = {/pingu/bill={#1}, /pingu/bill color={##1}},%
        /pingu/bill #1/.default = pingu@yellow% TODO: defaults
    }%
    \pingu@bill@add{#1}{#2}%
}

\@pingu@bill@s{normal}{%
\pingu@block{\pingu@color@bill} (\pingu@name-bill)++(-.19cm,0)
    arc (180:360:.19cm and .225cm)
    coordinate[pos=.5] (\pingu@name-bill-bottom)
    to[bend right=.25cm] cycle;
}

\@pingu@bill@s{flat}{%
\pingu@block{\pingu@color@bill} (\pingu@name-bill)++(-.19cm,0)
    arc (180:360:.19cm and .225cm)
    coordinate[pos=.5] (\pingu@name-bill-bottom)
    -- cycle;
}

\@pingu@bill@s{angry}{%
\pingu@block{\pingu@color@bill} (\pingu@name-bill)++(-.19cm,0)
    to[out=-90,in=170] ++(1.9mm,-2.25mm) coordinate (\pingu@name-bill-bottom)
    to[out=10,in=-90] ++(1.9mm,2.25mm)
    to[bend right=.25cm] cycle;
}
% #endregion

% #region dots
\def\@pingu@draw@dots{%
\pingu@layer{foreground}[]
  \@for\@pingu@elem:={belly-center,head,head-top,foot-left,foot-right,right-eye,left-eye,bill,bill-bottom,wings-side-left,wings-side-right,wing-left-start,wing-left-tip,wing-right-start,wing-right-tip,head-right,head-left,head-center,head-back-con-left,head-back-con-right,bottom-center,waist-left,waist-right}\do{
    \path[fill=green] (\pingu@name-\@pingu@elem) circle[radius=1.125\p@];
  }
  \@for\@pingu@elem:={wing-left,wing-right}\do{
    \path[fill=yellow] (\pingu@name-\@pingu@elem) circle[radius=1.125\p@];
  }

  \csname @pingu@wingitem@\@pingu@select@leftwing@ @\endcsname \colorlet{@wmark}{magenta} \else \colorlet{@wmark}{teal} \fi
  \pingu@block[/pingu/@draw=@wmark,thick,rotate around={\csname @pingu@wingangle@\@pingu@select@leftwing@ @\endcsname:(\pingu@name-wing-left)}]{@wmark}
    (\pingu@name-wing-left)++(0,3mm) circle [radius=1mm] -- ++(0,-6mm);
  \csname @pingu@wingitem@\@pingu@select@rightwing@ @\endcsname \colorlet{@wmark}{magenta} \else \colorlet{@wmark}{teal} \fi
  \pingu@block[/pingu/@draw=@wmark,thick,rotate around={-\csname @pingu@wingangle@\@pingu@select@rightwing@ @\endcsname:(\pingu@name-wing-right)}]{@wmark}
    (\pingu@name-wing-right)++(0,3mm) circle [radius=1mm] -- ++(0,-6mm);
\endpingu@layer}
% endregion

% #region extras
%     #region extras below
\def\pingu@draw@extras@below{%
    \if@pingu@x@tie@ \pingu@draw@eb@tie \fi
    \if@pingu@x@bowtie@ \pingu@draw@eb@bowtie \fi
    \if@pingu@x@pants@ \pingu@draw@eb@pants \fi
    \if@pingu@x@medal@ \pingu@draw@eb@medal \fi
    \if@pingu@x@cup@ \pingu@draw@eb@cup \fi
    \if@pingu@x@eyepatchleft@ \pingu@draw@eb@eyepatch@l \fi
    \if@pingu@x@eyepatchright@ \pingu@draw@eb@eyepatch@r \fi
}

% .########.####.########
% ....##.....##..##......
% ....##.....##..##......
% ....##.....##..######..
% ....##.....##..##......
% ....##.....##..##......
% ....##....####.########
\pingu@create@extra{tie}{%
    tie/.code         = \pingu@set@extra{tie}{true}\pingu@color{tie}{#1},
    tie/.default      = pingu@green,
    tie knot/.code    = \pingu@color{tie@knot}{#1},
    tie length/.code  = \def\pingu@x@tie@length{#1},
    tie offset/.code  = \def\pingu@x@tie@offset{#1},
    tie width/.code   = \def\pingu@x@tie@width{#1},
    tie pattern/.code = \def\pingu@x@tie@pattern{#1},
    tie dots/.style   = {%
        tie pattern={%
            \pingu@block[postaction={pattern={Dots[angle=40,distance=1.5pt,radius=.35pt]},pattern color=#1}]{\pingu@color@tie} \pingupathxtie;
            \pingu@block[postaction={pattern={Dots[angle=-30,distance=1.45pt,radius=.35pt@]},pattern color=#1}]{\pingu@color@tie@knot} \pingupathxtieknot;
        }
    }
}{% defaults
    tie length=.625\pingu@side@h@half,  tie offset=.399cm,%
    tie knot=\pingu@color@tie!92!black, tie width=.21cm,%
    tie pattern={%
        \pingu@block{\pingu@color@tie} \pingupathxtie;
        \pingu@block{\pingu@color@tie@knot} \pingupathxtieknot;
    }%
}
\def\pingupathxtie{[rounded corners=.15mm] (\pingu@name-tie-start)++(-.4mm,-.25mm) -- ++(-\pingu@x@tie@width/2, -\pingu@x@tie@length+.125cm) -- ++(\pingu@x@tie@width/2+.4mm,-.125cm) -- ++(\pingu@x@tie@width/2+.4mm,.125cm) -- +(-\pingu@x@tie@width/2, \pingu@x@tie@length-.125cm) -- cycle}
\def\pingupathxtieknot{[rounded corners=.25mm] (\pingu@name-tie-start)++(-.095cm-.02*\pingu@x@tie@width,\z@) -- ++(.3mm,-.15cm-.01*\pingu@x@tie@width) -- ++(.13cm+.04*\pingu@x@tie@width,\z@) -- ++(.3mm,.15cm+.01*\pingu@x@tie@width) -- cycle}
\def\pingu@draw@eb@tie{%
    \path (\pingu@name-bill)++(0,-\pingu@x@tie@offset) coordinate(\pingu@name-tie-start);
    \pingu@x@tie@pattern
}

% .########...#######..##......##....########.####.########
% .##.....##.##.....##.##..##..##.......##.....##..##......
% .##.....##.##.....##.##..##..##.......##.....##..##......
% .########..##.....##.##..##..##.......##.....##..######..
% .##.....##.##.....##.##..##..##.......##.....##..##......
% .##.....##.##.....##.##..##..##.......##.....##..##......
% .########...#######...###..###........##....####.########
\pingu@create@extra{bowtie}{%
    bowtie/.forward to         = /pingu/bow tie,
    bow-tie/.forward to        = /pingu/bow tie,
    bow tie/.code              = \pingu@set@extra{bowtie}{true}\pingu@color{bowtie}{#1},
    bow tie b/.code            = \pingu@color{bowtie@b}{#1},
    bow tie/.default           = pingu@blue,
    bowtie offset/.forward to  = /pingu/bow tie offset,
    bow-tie offset/.forward to = /pingu/bow tie offset,
    bow tie offset/.code       = \def\pingu@x@bowtie@offset{#1},
    bowtie knot/.forward to    = /pingu/bow tie knot,
    bow-tie knot/.forward to   = /pingu/bow tie knot,
    bow tie knot/.code         = \pingu@color{bowtie@knot}{#1},
}{% defaults
    bow tie knot=\pingu@color@bowtie!92!black,bow tie offset=.315cm,%
    bow tie b=\pingu@color@bowtie%
}

\def\pingupathxbowtieknot{[rounded corners=.25mm] (\pingu@name-bow-tie-start)++(-.0625cm,-.35mm) to[bend right=10] ++(.125cm,0) -- ++(0,-.13cm) to[bend right=10] ++(-.125cm, 0) -- cycle}
\def\pingupathxbowtieleft{[rounded corners=.25mm]  (\pingu@name-bow-tie-start)++(-.15mm,-.06cm) to[out=155,in=-5] ++(-.25cm,.065cm) to[bend right=15] ++(0,-.21cm) to[in=-155,out=5] ++(.25cm,.065cm) -- cycle}
\def\pingupathxbowtieright{[rounded corners=.25mm]  (\pingu@name-bow-tie-start)++(.15mm,-.06cm) to[out=25,in=-175] ++(.25cm,.065cm) to[bend left=15] ++(0,-.21cm) to[in=-25,out=175] ++(-.25cm,.065cm) -- cycle}
\def\pingu@draw@eb@bowtie{%
    \path (\pingu@name-bill)++(0,-\pingu@x@bowtie@offset) coordinate(\pingu@name-bow-tie-start);
    \pingu@block{\pingu@color@bowtie} \pingupathxbowtieleft;
    \pingu@block{\pingu@color@bowtie@b} \pingupathxbowtieright;
    \pingu@block{\pingu@color@bowtie@knot} \pingupathxbowtieknot;
}


% ..######..##.....##.########.
% .##....##.##.....##.##.....##
% .##.......##.....##.##.....##
% .##.......##.....##.########.
% .##.......##.....##.##.......
% .##....##.##.....##.##.......
% ..######...#######..##.......
\pingu@create@extra{cup}{%
  % extra cup % TODO: as selection
  cup/.code       = {\pingu@set@extra{cup}{true}\pingu@color{cup}{#1}},
  cup/.default    = pingu@green,
  cup straw/.code = \pingu@color{cup@straw}{#1}%
}{cup straw=\pingu@color@cup}

\def\pingu@draw@eb@cup{%
    \pingu@block[rounded corners=.25mm]{\pingu@color@cup} (\pingu@name-belly-center)++(-.325cm,.275cm) to[bend right=2] ++(.5mm,-.675cm) to[bend right=8] ++(.55cm,\z@) to[bend right=2] ++(.5mm,.675cm);
    \path (\pingu@name-belly-center)++(0,.275cm) -- (\pingu@name-bill) coordinate[pos=.5,xshift=-.2cm] (\pingu@name-cup-straw-outer-angle);
    \path (\pingu@name-belly-center)++(-.115cm,.275cm) coordinate (\pingu@name-straw-outer-start);
    \pingu@block[rounded corners=.15mm]{\pingu@color@cup@straw} (\pingu@name-straw-outer-start) -- (\pingu@name-cup-straw-outer-angle) -- (\pingu@name-bill) -- ++(.5mm,0) -- ([xshift=.5mm]\pingu@name-cup-straw-outer-angle) -- ([xshift=.5mm]\pingu@name-straw-outer-start) -- cycle;
    \pingu@block{\pingu@color@cup} (\pingu@name-belly-center)++(0,.275cm) ellipse [x radius=.325cm,y radius=.5mm];
}


% .##.....##.########.########.....###....##......
% .###...###.##.......##.....##...##.##...##......
% .####.####.##.......##.....##..##...##..##......
% .##.###.##.######...##.....##.##.....##.##......
% .##.....##.##.......##.....##.#########.##......
% .##.....##.##.......##.....##.##.....##.##......
% .##.....##.########.########..##.....##.########
\pingu@create@extra{medal}{%
    % TODO: medal band
    medal/.code    	  = {\pingu@set@extra{medal}{true}\pingu@color{medal}{#1}},
    medal/.default    = pingu@yellow,%
    gold medal/.style = {medal, medal text=#1}, gold medal/.default={1},
    silver medal/.style = {medal=pingu@silver, medal text=#1}, silver medal/.default={2},
    bronze medal/.style = {medal=pingu@bronze, medal text=#1}, bronze medal/.default={3},
    medal band/.code  = \pingu@color{medal@band}{#1},%
    medal shade/.code  = \pingu@color{medal@shade}{#1},%
    medal shade width/.code  = \def\pingu@medal@shade@w{#1},%
    medal text/.code  = \def\pingu@x@medal@text{#1},%
    medal text style/.style = {\pingu@color@medal!65!pingu@white},
}{medal band=pingu@red,medal text={},medal shade={\pingu@color@medal!65!pingu@white},medal shade width=.75\p@}

\def\pingu@draw@eb@medal{%
\coordinate (\pingu@name-medal-center) at ([yshift=1.25mm]\pingu@name-belly-center);
\pingu@block{\pingu@color@medal@band} [rounded corners=.15mm] (\pingu@name-head-back-con-right) -- (\pingu@name-medal-center) -- (\pingu@name-head-back-con-left) to[bend left=11] ++(-1.35mm,-.5mm) -- ([yshift=.7mm]\pingu@name-medal-center) -- ([xshift=1.35mm,yshift=-.5mm]\pingu@name-head-back-con-right) to[bend left=11] (\pingu@name-head-back-con-right) -- cycle;
\pingu@block{\pingu@color@medal} (\pingu@name-medal-center) circle [radius=2.35mm];
\pingu@draw[line width=\pingu@medal@shade@w]{\pingu@color@medal@shade} (\pingu@name-medal-center) circle [radius=2.35mm];
\node[/pingu/@text,/pingu/medal text style] at (\pingu@name-medal-center) {\pingu@x@medal@text};
}

% .########.##....##.########....########.....###....########..######..##.....##
% .##........##..##..##..........##.....##...##.##......##....##....##.##.....##
% .##.........####...##..........##.....##..##...##.....##....##.......##.....##
% .######......##....######......########..##.....##....##....##.......#########
% .##..........##....##..........##........#########....##....##.......##.....##
% .##..........##....##..........##........##.....##....##....##....##.##.....##
% .########....##....########....##........##.....##....##.....######..##.....##
\pingu@create@extra{eyepatchleft}{%
    eyepatch left/.forward to = /pingu/eye patch left,
    eye patch left/.code      = \pingu@set@extra{eyepatchleft}{true}\pingu@color{eyepatchleft}{#1},
    eye patch left/.default   = \pingu@color@body@main,
}{}

\newlength\pingu@patchw \pingu@patchw=6.5pt
\def\pingu@draw@eb@eyepatch@l{%
    \pingu@draw[line width=1.25pt,line cap=round]{\pingu@color@eyepatchleft} (\pingu@name-head-right)++(-2.75mm,-2.5mm) to[bend right=10] coordinate[pos=.71] (\pingu@name-left-eye-patch) ([xshift=-.85mm,yshift=1.25mm]\pingu@name-wings-side-left);
    \pingu@block[rotate around={-9:(\pingu@name-left-eye-patch)}]{\pingu@color@eyepatchleft} (\pingu@name-left-eye-patch)++(0,.5pt) ellipse [x radius=\pingu@patchw, y radius=.65pt];
    \pingu@block[rotate around={-9:(\pingu@name-left-eye-patch)}]{\pingu@color@eyepatchleft} (\pingu@name-left-eye-patch) ++(-\pingu@patchw,.5pt) arc(180:360:\pingu@patchw{} and 8.9pt);
}

\pingu@create@extra{eyepatchright}{%
    eyepatch right/.forward to = /pingu/eye patch right,
    eye patch right/.code      = \pingu@set@extra{eyepatchright}{true}\pingu@color{eyepatchright}{#1},
    eye patch right/.default   = \pingu@color@body@main,
}{}

\def\pingu@draw@eb@eyepatch@r{%
    \pingu@draw[line width=1.25pt,line cap=round]{\pingu@color@eyepatchright} (\pingu@name-head-left)++(2.75mm,-2.5mm) to[bend left=10] coordinate[pos=.71] (\pingu@name-right-eye-patch) ([xshift=.85mm,yshift=1.25mm]\pingu@name-wings-side-right);
    \pingu@block[rotate around={9:(\pingu@name-right-eye-patch)}]{\pingu@color@eyepatchright} (\pingu@name-right-eye-patch)++(0,.5pt) ellipse [x radius=\pingu@patchw, y radius=.65pt];
    \pingu@block[rotate around={9:(\pingu@name-right-eye-patch)}]{\pingu@color@eyepatchright} (\pingu@name-right-eye-patch) ++(-\pingu@patchw,.5pt) arc(180:360:\pingu@patchw{} and 8.9pt);
}


% .########.....###....##....##.########..######.
% .##.....##...##.##...###...##....##....##....##
% .##.....##..##...##..####..##....##....##......
% .########..##.....##.##.##.##....##.....######.
% .##........#########.##..####....##..........##
% .##........##.....##.##...###....##....##....##
% .##........##.....##.##....##....##.....######.
\newif\if@pingu@x@pants@bands
\pingu@create@extra{pants}{%
    pants/.code    	               = \pingu@set@extra{pants}{true}\pingu@color{pants}{#1},
    pants/.default                 = pingu@red,
    pants button left/.code        = \pingu@color{pants@button@left}{#1},
    pants bands/.is if             = @pingu@x@pants@bands,
    pants button right/.code       = \pingu@color{pants@button@right}{#1},
    pants buttons/.style           = {/pingu/pants button left={#1}, /pingu/pants button right={#1}},
    pants button left shade/.code  = \pingu@color{pants@button@left@shade}{#1},
    pants button right shade/.code = \pingu@color{pants@button@right@shade}{#1},
    pants buttons shade/.style     = {/pingu/pants button left shade={#1}, /pingu/pants button right shade={#1}},
    pants without buttons/.forward to=/pingu/pants no buttons,
    pants no buttons/.style        = {/pingu/pants buttons=\@pingu@none, /pingu/pants buttons shade=\@pingu@none},
    pants extra height/.code = \def\pingu@x@pants@extra@height{#1},
}{pants extra height=1.5mm,pants buttons=pingu@black,pants button left shade=\pingu@color@pants@button@left!70!white,pants button right shade=\pingu@color@pants@button@right!70!white}

\def\pingu@draw@eb@pants{%
\pingu@block[rounded corners=\p@]{\pingu@color@pants} ([xshift=.85mm,yshift=\pingu@x@pants@extra@height]\pingu@name-waist-right) coordinate(@tmp) to[bend right=6] ([xshift=-.85mm,yshift=\pingu@x@pants@extra@height]\pingu@name-waist-left) coordinate(@tmpb) -- ++(0,-\pingu@x@pants@extra@height) arc(180:270:.85mm and 2.5mm) to[bend left=\pingu@bend] (\pingu@name-bottom-center-|\pingu@name-waist-left) to[bend left=15] ([yshift=-.15mm]\pingu@name-bottom-center) to[bend left=15] (\pingu@name-bottom-center-|\pingu@name-waist-right) to[bend left=6] ([yshift=-2.5mm]\pingu@name-waist-right) arc (-90:0:.85mm and 2.5mm) -- cycle;
\if@pingu@x@pants@bands
\pingu@layer{middle}[]
% draw stripes
\scope
\clip \pingu@path@lowerpingu;
\pingu@block{\pingu@color@pants} (@tmp)++(.55mm,-1mm) to[bend right=3] ([yshift=1.65mm]\pingu@name-wings-side-right) -- ++(-.25mm,-.25mm) to[bend left=3] ([yshift=-1mm]@tmp) -- cycle;
\pingu@block{\pingu@color@pants} (@tmpb)++(-.55mm,-1mm) to[bend left=3] ([yshift=1.65mm]\pingu@name-wings-side-left) -- ++(.25mm,-.25mm) to[bend right=3] ([yshift=-1mm]@tmpb) -- cycle;
\endscope
\fi
\pingu@block{\pingu@color@pants@button@right}(@tmp)++(.25mm,-.25mm)circle[radius=.7mm];
\pingu@block{\pingu@color@pants@button@left}(@tmpb)++(-.25mm,-.25mm)circle[radius=.7mm];
\pingu@block[even odd rule]{\pingu@color@pants@button@right@shade}(@tmp)++(.25mm,-.25mm)circle[radius=.7mm] circle[radius=.615mm];
\pingu@block[even odd rule]{\pingu@color@pants@button@left@shade}(@tmpb)++(-.25mm,-.25mm)circle[radius=.7mm] circle[radius=.615mm];
\@for\i:={0,90,180,270}\do{
    \pingu@block{\pingu@color@pants@button@right@shade} (@tmp)++(.25mm,-.25mm)++(\i:.
    35mm) circle[radius=.1mm];
    \pingu@block{\pingu@color@pants@button@left@shade} (@tmpb)++(-.25mm,-.25mm)++(\i:.35mm) circle[radius=.1mm];
}%
\if@pingu@x@pants@bands
\endpingu@layer
\fi
}
%     #endregion

%     #region extras above
% NOTE: No auto append to allow easy order change
\def\pingu@draw@extras@above{%
    \if@pingu@x@eyeframe@ \pingu@draw@ea@eyeframe \fi
    \if@pingu@x@glasses@ \pingu@draw@ea@glasses \fi
    \if@pingu@x@glassesround@ \pingu@draw@ea@glassesround \fi
    \if@pingu@x@devilhorns@ \pingu@draw@ea@devilhorns \fi
    \if@pingu@x@strawhat@ \pingu@draw@ea@strawhat \fi
    \if@pingu@x@hat@ \pingu@draw@ea@hat \fi
    \if@pingu@x@crown@ \pingu@draw@ea@crown \fi
    \if@pingu@x@rook@ \pingu@draw@ea@rook \fi
    \if@pingu@x@halo@ \pingu@draw@ea@halo \fi
}

% ..######..########.########.....###....##......##....##.....##....###....########
% .##....##....##....##.....##...##.##...##..##..##....##.....##...##.##......##...
% .##..........##....##.....##..##...##..##..##..##....##.....##..##...##.....##...
% ..######.....##....########..##.....##.##..##..##....#########.##.....##....##...
% .......##....##....##...##...#########.##..##..##....##.....##.#########....##...
% .##....##....##....##....##..##.....##.##..##..##....##.....##.##.....##....##...
% ..######.....##....##.....##.##.....##..###..###.....##.....##.##.....##....##...
\pingu@create@extra{strawhat}{%
  % extra strawhat (tikzducks basis)
  straw hat/.forward to         = /pingu/strawhat,
  strawhat/.default             = brown!50!white,
  strawhat/.code                = \pingu@set@extra{strawhat}{true}\pingu@color{strawhat}{#1},
  straw hat ribbon/.forward to  = /pingu/strawhat ribbon,
  strawhat ribbon/.code         = \pingu@color{strawhat@ribbon}{#1},
  straw hat position/.forward to= /pingu/strawhat position,
  strawhat position/.code args  = {#1:(#2,#3)#4}{\def\pingu@x@strawhat@angle{#1}\def\pingu@x@strawhat@xshift{#2}\def\pingu@x@strawhat@yshift{#3}\def\pingu@x@strawhat@scale{#4}},
}{strawhat ribbon= gray!85!black,strawhat position={-26.5:(-.185cm,.14cm){1.375}}}

\def\pingu@draw@ea@strawhat{%
\scope[rotate around={\pingu@x@strawhat@angle:(\pingu@name-head)},shift={(\pingu@name-head)},shift={(\pingu@x@strawhat@xshift,\pingu@x@strawhat@yshift)},scale=\pingu@x@strawhat@scale]
\pingu@block{\pingu@color@strawhat} (.34cm,\z@) ellipse[x radius=.75cm, y radius=1mm];
\pingu@block{\pingu@color@strawhat} (\z@,.5mm) rectangle (.68cm,.5cm);
\pingu@block{\pingu@color@strawhat} (.34cm,.5cm) ellipse[x radius=.34cm, y radius=.08cm];
\pingu@block{\pingu@color@strawhat} (-.3955cm,.02cm) -- (1.0755cm,.02cm) -- (.68cm,.2cm) -- (0,.2cm) -- cycle;
\pingu@block{\pingu@color@strawhat@ribbon} (.34cm,.2cm) ellipse[x radius=.34cm, y radius=.08cm];
\pingu@block{\pingu@color@strawhat@ribbon} (\z@,.2cm) rectangle (.68cm,.3cm);
\pingu@block{\pingu@color@strawhat} (.34cm,.3cm) ellipse[x radius=.34cm, y radius=.08cm];
\endscope}

% .##.....##....###....########
% .##.....##...##.##......##...
% .##.....##..##...##.....##...
% .#########.##.....##....##...
% .##.....##.#########....##...
% .##.....##.##.....##....##...
% .##.....##.##.....##....##...
\pingu@create@extra{hat}{%
  hat/.default   = pingu@black!90!black,
  hat/.code      = \pingu@set@extra{hat}{true}\pingu@color{hat}{#1},
  hat base/.code = \pingu@color{hat@base}{#1},
  hat coronal/.code = \pingu@color{hat@coronal}{#1},
  hat ribbon/.code = \pingu@color{hat@ribbon}{#1},
  hat position/.code args  = {#1:(#2,#3)#4}{\def\pingu@x@hat@angle{#1}\def\pingu@x@hat@xshift{#2}\def\pingu@x@hat@yshift{#3}\def\pingu@x@hat@scale{#4}},
}{hat position={-2:(.35mm,0)1},hat base=\pingu@color@hat,hat coronal=\pingu@color@hat!91!white,hat ribbon=\pingu@color@hat!87!white}

\newdimen\pingu@hat@w@half \pingu@hat@w@half=.925cm
\newdimen\pingu@hat@h \pingu@hat@h=.625cm
\def\pingupathhatupper{[rounded corners=.25mm](-.65cm,-.25cm) to[out=90,in=200] ++(.35cm,\pingu@hat@h) to[bend left=11] ++(.25cm,0) to[bend right=2.5] ++(1mm,0) to[bend left=11] ++(.25cm,0) to[out=-20,in=90] ++(.35cm,-\pingu@hat@h) to[bend left=12] (-.65cm,-.25cm) -- cycle}
\def\pingu@draw@ea@hat{%
\scope[rotate around={\pingu@x@hat@angle:(\pingu@name-head-top)},shift={(\pingu@name-head-top)},shift={(\pingu@x@hat@xshift,\pingu@x@hat@yshift)},scale=\pingu@x@hat@scale]
\pingu@block[/pingu/@draw=\pingu@color@hat@coronal,thick]{\pingu@color@hat@base} (0,-.25cm)++(180:\pingu@hat@w@half{} and .15cm) arc (180:360:\pingu@hat@w@half{} and .15cm) arc (0:180:\pingu@hat@w@half{} and .115cm) -- cycle;
\pingu@block{\pingu@color@hat} \pingupathhatupper;
\scope
\clip\pingupathhatupper;
\pingu@block{\pingu@color@hat@ribbon} (\z@,.02cm) ellipse [x radius=.95\pingu@hat@w@half, y radius=.13cm];
\pingu@block{\pingu@color@hat} (\z@,.134cm) ellipse [x radius=.95\pingu@hat@w@half, y radius=.13cm];
\endscope\endscope}

% ..######..########...#######..##......##.##....##
% .##....##.##.....##.##.....##.##..##..##.###...##
% .##.......##.....##.##.....##.##..##..##.####..##
% .##.......########..##.....##.##..##..##.##.##.##
% .##.......##...##...##.....##.##..##..##.##..####
% .##....##.##....##..##.....##.##..##..##.##...###
% ..######..##.....##..#######...###..###..##....##
\newif\if@pingu@x@crown@ddd@ % 3d
\newif\if@pingu@x@crown@shade@ % 3d
\pingu@create@extra{crown}{%
  crown/.code             = \pingu@set@extra{crown}{true}\pingu@color{crown}{#1},
  crown/.default          = pingu@yellow,
  crown 3d/.is if         = @pingu@x@crown@ddd@, crown 3d/.default = true,
  crown 2d/.style         = {crown=#1, crown 3d=false},
  crown 2d/.default       = pingu@yellow,
  crown back/.code        = \pingu@color{crown@back}{#1},
  crown front bend/.code  = \def\pingu@x@crown@f@bend{#1},
  crown back bend/.code   = \def\pingu@x@crown@b@bend{#1},
  crown gem shade/.is if  = @pingu@x@crown@shade@, crown gem shade/.default = true,
  crown gem colors/.code n args = 7{\pingu@color{crown@gem@a}{#1}\pingu@color{crown@gem@b}{#2}\pingu@color{crown@gem@c}{#3}\pingu@color{crown@gem@d}{#4}\pingu@color{crown@gem@e}{#5}\pingu@color{crown@gem@f}{#6}\pingu@color{crown@gem@g}{#7}},
  crown gem ring/.code   = \pingu@color{crown@gem@ring}{#1},
  crown position/.code args  = {#1:(#2,#3)#4}{\def\pingu@x@crown@angle{#1}\def\pingu@x@crown@xshift{#2}\def\pingu@x@crown@yshift{#3}\def\pingu@x@crown@scale{#4}},
}{crown position={-9:(1mm,0)1},crown front bend=16,crown back bend=9,crown back=\pingu@color@crown!93!black,crown 3d,crown gem colors={pingu@purple}{pingu@blue}{pingu@green}{pingu@purple}{pingu@green}{pingu@blue}{pingu@purple},crown gem ring=\pingu@color@crown!85!white,crown gem shade}

% color | bend1 | bend1
\def\pingu@draw@ea@crown@s#1#2#3{
\pingu@block{#1} [rounded corners=.2mm](-6.25mm,-.25cm) to[bend left=2] ++(0,3.125mm) to[bend #2=\pingu@x@crown@f@bend]
    coordinate[pos=0] (r2)  coordinate[pos=.07] (r1)
    coordinate[pos=.14-.07] (a1)  coordinate[pos=.14] (a2) coordinate[pos=.14+.07] (a3)
    coordinate[pos=.30-.08] (b1)  coordinate[pos=.30] (b2) coordinate[pos=.30+.08] (b3)
    coordinate[pos=.50- .1] (c1)  coordinate[pos=.50] (x2) coordinate[pos=.50+ .1] (c3)
    coordinate[pos=.69-.08] (d1)  coordinate[pos=.69] (d2) coordinate[pos=.69+.08] (d3)
    coordinate[pos=.85-.07] (e1)  coordinate[pos=.85] (e2) coordinate[pos=.85+.07] (e3)
    coordinate[pos=1] (l2)  coordinate[pos=.93] (l1)
    ++(1.375cm,0) to[bend left=2] ++(0,-3.125mm) to[bend #3=\pingu@x@crown@f@bend] (-6mm,-.25cm) -- cycle;
\path (x2)++(0,.9mm) coordinate (c2);
\@for\a:={a,b,c,d,e}\do{
    \pingu@block{#1} ([yshift=-.1mm]\a1) to[bend right=\pingu@x@crown@f@bend] ([yshift=-.1mm]\a3) to[bend right=2] ([yshift=1.85mm]\a2) to[bend right=2] ([yshift=-.1mm]\a1) -- cycle;
}
\pingu@block{#1} (l2)++(0,-.2mm) to[bend right=2] ++(0,1.95mm) -- (l1) -- cycle;
\pingu@block{#1} (r2)++(0,-.2mm) to[bend left=2] ++(0,1.95mm) -- (r1) -- cycle;
}

% TODO: shading option
% color | at | shift | scale
\def\pingu@draw@ea@crown@g#1#2#3#4{
\scope[shift={(#22)},shift={(#3,-.33mm)}]
    \pingu@block{\pingu@color@crown@gem@ring}  ellipse [x radius=.715mm*#4, y radius=.925mm*#4];
    \pingu@block{#1}  ellipse [x radius=.633mm*#4, y radius=.85mm*#4];
    \protected@edef\@tmp{#1}\ifx\@tmp\@pingu@none\else
    \if@pingu@x@crown@shade@
    \shade[ball color=#1,fill opacity=.45,shading angle=-95]  ellipse [x radius=.633mm*#4, y radius=.85mm*#4];
    \else
    \pingu@block[rotate around={7:(42:.3mm*#4 and .4mm*#4)}]{#1!45!pingu@white} (42:.3mm*#4 and .4mm*#4) ellipse[x radius=.17mm*#4, y radius=.24mm*#4];
    \pingu@block[rotate around={7:(232:.275mm*#4 and .35mm*#4)}]{#1!45!pingu@white} (232:.275mm*#4 and .35mm*#4) ellipse[x radius=.06mm*#4, y radius=.085mm*#4];
    \fi\fi
\endscope
}
\def\pingu@draw@ea@crown{%
\scope[rotate around={\pingu@x@crown@angle:(\pingu@name-head-top)},%
       shift={(\pingu@name-head-top)},
       shift={(\pingu@x@crown@xshift,\pingu@x@crown@yshift)},
       scale=\pingu@x@crown@scale]
% draw front
\if@pingu@x@crown@ddd@
    \pingu@draw@ea@crown@s{\pingu@color@crown}{right}{left}
    \def\@tmpa{.05mm}\def\@tmpb{.025mm}
\else
    \pingu@draw@ea@crown@s{\pingu@color@crown}{left}{right}
    \def\@tmpa{-.015mm}\def\@tmpb{-.035mm}
\fi
% draw the emaralds
\pingu@draw@ea@crown@g{\pingu@color@crown@gem@b}{a}{-\@tmpa}1
\pingu@draw@ea@crown@g{\pingu@color@crown@gem@c}{b}{-\@tmpb}1
\pingu@draw@ea@crown@g{\pingu@color@crown@gem@d}{x}{\z@}{1.35}
\pingu@draw@ea@crown@g{\pingu@color@crown@gem@e}{d}{\@tmpb}1
\pingu@draw@ea@crown@g{\pingu@color@crown@gem@f}{e}{\@tmpa}1
\pingu@layer{background}[]
\pingu@block{\pingu@color@crown@gem@a} (r2)++(0,-.33mm) ellipse [x radius=.3mm, y radius=.8mm];
\pingu@block{\pingu@color@crown@gem@ring} (r2)++(0,-.33mm) ellipse [x radius=.1mm, y radius=.885mm];
\pingu@block{\pingu@color@crown@gem@g} (l2)++(0,-.33mm) ellipse [x radius=.3mm, y radius=.8mm];
\pingu@block{\pingu@color@crown@gem@ring} (l2)++(0,-.33mm) ellipse [x radius=.1mm, y radius=.885mm];
% draw back if 3d
\if@pingu@x@crown@ddd@
    \pingu@draw@ea@crown@s{\pingu@color@crown@back}{left}{right}
\fi
\endpingu@layer
\endscope
}

% .##.....##....###....##........#######.
% .##.....##...##.##...##.......##.....##
% .##.....##..##...##..##.......##.....##
% .#########.##.....##.##.......##.....##
% .##.....##.#########.##.......##.....##
% .##.....##.##.....##.##.......##.....##
% .##.....##.##.....##.########..#######.
\newif\if@pingu@x@halo@glow
\pingu@create@extra{halo}{%
    halo/.code    	 = \pingu@set@extra{halo}{true}\pingu@color{halo}{#1},
    halo/.default    = pingu@lightblue,
    halo raise/.code = \def\pingu@x@halo@raise{#1},
    halo glow/.is if = @pingu@x@halo@glow% only active if glows loaded
}{halo glow=\ifpengu@setup@glows@ true\else false\fi,halo raise=0mm}

\def\pingu@draw@ea@halo{%
\pingu@block[even odd rule]{\pingu@color@halo} ([yshift=\pingu@x@halo@raise]\pingu@name-head-top) ellipse [x radius=\pingu@w@half-1mm,y radius=2.5mm] ellipse [x radius=\pingu@w@half-1.95mm,y radius=1.55mm];
\if@pingu@x@halo@glow
\pingu@block[even odd rule,/pingu/@glow]{\pingu@color@halo} ([yshift=\pingu@x@halo@raise]\pingu@name-head-top) ellipse [x radius=(\pingu@w@half-1.95mm)*1.7,y radius=1.55mm*2.35] ellipse [x radius=\pingu@w@half-1.95mm,y radius=1.55mm];
\fi
}

% .########.##....##.########.########.########.....###....##.....##.########
% .##........##..##..##.......##.......##.....##...##.##...###...###.##......
% .##.........####...##.......##.......##.....##..##...##..####.####.##......
% .######......##....######...######...########..##.....##.##.###.##.######..
% .##..........##....##.......##.......##...##...#########.##.....##.##......
% .##..........##....##.......##.......##....##..##.....##.##.....##.##......
% .########....##....########.##.......##.....##.##.....##.##.....##.########
\pingu@create@extra{eyeframe}{%
    % extra halo
    eyeframe/.forward to = /pingu/eye frame,
    eye frame/.code      = \pingu@set@extra{eyeframe}{true}\pingu@color{eyeframe}{#1},
    eye frame/.default   = pingu@black,
}{}

\def\pingu@draw@ea@eyeframe{%
    % TODO: dynamic offsets
    \pingu@draw{\pingu@color@eyeframe} [rounded corners=.25mm](\pingu@name-left-eye)++(-2mm,1.5mm) to[bend left=8] ++(4.2mm,0) to[out=-80,in=70] ++(-.2mm,-2.75mm) to[bend left=32.5] ++(-3.65mm,0mm) to[out=135,in=-90] ++(-.8mm,2.7mm) -- cycle;
    \pingu@draw{\pingu@color@eyeframe} [rounded corners=.25mm](\pingu@name-right-eye)++(2mm,1.5mm) to[bend right=8] ++(-4.2mm,0) to[out=-100,in=110] ++(.2mm,-2.75mm) to[bend right=32.5] ++(3.65mm,0mm) to[out=45,in=-90] ++(.8mm,2.7mm) -- cycle;
}

% TODO: use save paths for everything

% ..######...##..........###.....######...######..########..######.
% .##....##..##.........##.##...##....##.##....##.##.......##....##
% .##........##........##...##..##.......##.......##.......##......
% .##...####.##.......##.....##..######...######..######....######.
% .##....##..##.......#########.......##.......##.##.............##
% .##....##..##.......##.....##.##....##.##....##.##.......##....##
% ..######...########.##.....##..######...######..########..######.
\pingu@create@extra{glasses}{%
    glasses/.code               = \pingu@set@extra{glasses}{true}\pingu@color{glasses}{#1},
    glasses/.default            = pingu@black,
    glasses left fill/.code     = \pingu@color{glasses@fill@l}{#1},
    glasses right fill/.code    = \pingu@color{glasses@fill@r}{#1},
    glasses left opacity/.code  = \def\pingu@x@glasses@op@l{#1},
    glasses right opacity/.code = \def\pingu@x@glasses@op@r{#1},
    glasses fill/.style         = {/pingu/glasses left fill=#1, /pingu/glasses right fill=#1},
    glasses opacity/.style      = {/pingu/glasses left opacity=#1, /pingu/glasses right opacity=#1},
    glasses line width/.code    = \def\pingu@x@glasses@lw{#1},
    sunglasses/.forward to      = /pingu/sun glasses,
    sun glasses/.style          = {/pingu/glasses, /pingu/glasses fill=#1},
    sun glasses/.default        = pingu@black,
}{glasses line width=1.125\p@,glasses fill=\@pingu@none,glasses opacity=.825}

\def\pingu@draw@ea@glasses{% fact: 1.33; modified first shift and ht
    \pingu@block[opacity=\pingu@x@glasses@op@l]{\pingu@color@glasses@fill@l} (\pingu@name-left-eye)++(-2.66mm,1.75mm) to[bend left=8] ++(5.586mm,0) to[out=-80,in=70] ++(-.266mm,-3.6mm) to[bend left=32.5] ++(-4.8545mm,0mm) to[out=135,in=-90] ++(-1.064mm,3.5mm) -- cycle;
    \pingu@block[opacity=\pingu@x@glasses@op@r]{\pingu@color@glasses@fill@r} (\pingu@name-right-eye)++(2.66mm,1.75mm) to[bend right=8] ++(-5.586mm,0) to[out=-100,in=110] ++(.266mm,-3.6mm) to[bend right=32.5] ++(4.8545mm,0mm) to[out=45,in=-90] ++(1.064mm,3.5mm) -- cycle;
    \pingu@draw[line width=\pingu@x@glasses@lw]{\pingu@color@glasses} [rounded corners=.25mm](\pingu@name-left-eye)++(-2.66mm,1.75mm) coordinate (\pingu@name-glasses-left-mid) to[bend left=8] ++(5.586mm,0) coordinate (\pingu@name-glasses-left-outer) to[out=-80,in=70] ++(-.266mm,-3.6mm) to[bend left=32.5] ++(-4.8545mm,0mm) to[out=135,in=-90] coordinate[pos=.9] (\pingu@name-glasses-left-mid-b) ++(-1.064mm,3.5mm) -- cycle;
    \pingu@draw[line width=\pingu@x@glasses@lw]{\pingu@color@glasses} [rounded corners=.25mm] (\pingu@name-right-eye)++(2.66mm,1.75mm) coordinate (\pingu@name-glasses-right-mid) to[bend right=8] ++(-5.586mm,0) coordinate (\pingu@name-glasses-right-outer) to[out=-100,in=110] ++(.266mm,-3.6mm) to[bend right=32.5] ++(4.8545mm,0mm) to[out=45,in=-90] coordinate[pos=.9] (\pingu@name-glasses-right-mid-b) ++(1.064mm,3.5mm) -- cycle;
    \pingu@draw[line width=\pingu@x@glasses@lw]{\pingu@color@glasses} (\pingu@name-glasses-right-mid) to[bend right=10] (\pingu@name-glasses-left-mid);
    \pingu@draw[line width=\pingu@x@glasses@lw]{\pingu@color@glasses} (\pingu@name-glasses-right-mid-b) to[bend left=20] (\pingu@name-glasses-left-mid-b);
    \scope
    \clip[use path=\pingu@upperpingu];
    \pingu@draw[line width=\pingu@x@glasses@lw]{\pingu@color@glasses}
    (\pingu@name-glasses-right-mid) to[bend right=8] ++(-5.586mm,0) -- ++(-5mm,.5mm);
    \pingu@draw[line width=\pingu@x@glasses@lw]{\pingu@color@glasses}
    (\pingu@name-glasses-left-mid) to[bend left=8] ++(5.586mm,0) -- ++(5mm,.5mm);
    \endscope
}

% ..######...##..........###.....######...######..########..######.....########...#######..##.....##.##....##.########.
% .##....##..##.........##.##...##....##.##....##.##.......##....##....##.....##.##.....##.##.....##.###...##.##.....##
% .##........##........##...##..##.......##.......##.......##..........##.....##.##.....##.##.....##.####..##.##.....##
% .##...####.##.......##.....##..######...######..######....######.....########..##.....##.##.....##.##.##.##.##.....##
% .##....##..##.......#########.......##.......##.##.............##....##...##...##.....##.##.....##.##..####.##.....##
% .##....##..##.......##.....##.##....##.##....##.##.......##....##....##....##..##.....##.##.....##.##...###.##.....##
% ..######...########.##.....##..######...######..########..######.....##.....##..#######...#######..##....##.########.
\pingu@create@extra{glassesround}{%
    glasses round/.code               = \pingu@set@extra{glassesround}{true}\pingu@color{glassesround}{#1},
    glasses round/.default            = pingu@black,
    glasses round left fill/.code     = \pingu@color{glassesround@fill@l}{#1},
    glasses round right fill/.code    = \pingu@color{glassesround@fill@r}{#1},
    glasses round fill/.style         = {/pingu/glasses round left fill=#1, /pingu/glasses round right fill=#1},
    glasses round left opacity/.code  = \def\pingu@x@glassesround@op@l{#1},
    glasses round right opacity/.code = \def\pingu@x@glassesround@op@r{#1},
    glasses round opacity/.style      = {/pingu/glasses round left opacity=#1, /pingu/glasses round right opacity=#1},
    glasses round left radius/.code  = \def\pingu@x@glassesround@r@l{#1},
    glasses round right radius/.code = \def\pingu@x@glassesround@r@r{#1},
    glasses round radius/.style      = {/pingu/glasses round left radius=#1, /pingu/glasses round right radius=#1},
    glasses round line width/.code    = \def\pingu@x@glassesround@lw{#1},
    sunglasses round/.forward to      = /pingu/sun glasses round,
    sun glasses round/.style          = {/pingu/glasses round, /pingu/glasses round fill=#1},
    sun glasses round/.default        = pingu@black,
    % todo: width/radius allow for different
}{glasses round line width=.75\p@,glasses round fill=\@pingu@none,glasses round opacity=.825,glasses round radius=3.15mm}

\def\pingu@draw@ea@glassesround{% fact: 1.33; modified first shift and ht
    \pingu@block[opacity=\pingu@x@glassesround@op@l]{\pingu@color@glassesround@fill@l} (\pingu@name-left-eye) circle [radius=\pingu@x@glassesround@r@l];
    \pingu@block[opacity=\pingu@x@glassesround@op@r]{\pingu@color@glassesround@fill@r} (\pingu@name-right-eye) circle [radius=\pingu@x@glassesround@r@r];
    \pingu@draw[line width=\pingu@x@glassesround@lw]{\pingu@color@glassesround} [rounded corners=.25mm](\pingu@name-left-eye) ++(150:\pingu@x@glassesround@r@l) coordinate (\pingu@name-glassesround-left-mid) arc (150:510:\pingu@x@glassesround@r@l);
    \pingu@draw[line width=\pingu@x@glassesround@lw]{\pingu@color@glassesround} [rounded corners=.25mm] (\pingu@name-right-eye) ++(30:\pingu@x@glassesround@r@r) coordinate (\pingu@name-glassesround-right-mid) arc (30:390:\pingu@x@glassesround@r@r);
    \pingu@draw[line width=\pingu@x@glassesround@lw]{\pingu@color@glassesround} (\pingu@name-glassesround-left-mid) to[bend right=30] (\pingu@name-glassesround-right-mid);
    \scope
    \clip[use path=\pingu@upperpingu];
    \pingu@draw[line width=\pingu@x@glassesround@lw]{\pingu@color@glassesround}
     (\pingu@name-glassesround-right-mid) arc(30:150:\pingu@x@glassesround@r@l) -- ++(-5mm,.65mm);
     \pingu@draw[line width=\pingu@x@glassesround@lw]{\pingu@color@glassesround}
     (\pingu@name-glassesround-left-mid) arc(150:30:\pingu@x@glassesround@r@r) -- ++(5mm,.65mm);
    \endscope
}

% .########..########.##.....##.####.##..........##.....##..#######..########..##....##..######.
% .##.....##.##.......##.....##..##..##..........##.....##.##.....##.##.....##.###...##.##....##
% .##.....##.##.......##.....##..##..##..........##.....##.##.....##.##.....##.####..##.##......
% .##.....##.######...##.....##..##..##..........#########.##.....##.########..##.##.##..######.
% .##.....##.##........##...##...##..##..........##.....##.##.....##.##...##...##..####.......##
% .##.....##.##.........##.##....##..##..........##.....##.##.....##.##....##..##...###.##....##
% .########..########....###....####.########....##.....##..#######..##.....##.##....##..######.
\pingu@create@extra{devilhorns}{%
    devilhorns/.forward to = /pingu/devil horns,
    devil-horns/.forward to = /pingu/devil horns,
    devil horns/.code    = \pingu@set@extra{devilhorns}{true}\pingu@color{devilhorns}{#1},
    devil horns/.default = pingu@purple,
    devil horns b/.code  = \pingu@color{devilhorns@b}{#1},
    devilhorns b/.forward to = /pingu/devil horns b,
    devil-horns b/.forward to = /pingu/devil horns b
}{devil horns b=\pingu@color@devilhorns}

\pgfmathsetmacro\pingu@devilhorns@baseang@l{90-360*(1-\pinguanglehl)}
\pgfmathsetmacro\pingu@devilhorns@baseang@r{90-360*(1-\pinguanglehr)}
\def\pingu@devilhorns@baseoff{12}
\def\pingu@devilhorns@yshift{.65mm}
\def\pingu@draw@ea@devilhorns{%
    % 90 - 360*.06
    \pingu@block{\pingu@color@devilhorns} ([yshift=-\pingu@devilhorns@yshift]\pingu@name-head-left) arc (\pingu@devilhorns@baseang@l:\pingu@devilhorns@baseang@l-\pingu@devilhorns@baseoff:\pingu@w@half{} and .9\pingu@w@half) coordinate (\pingu@name-devilhorns-left-goal) to[out=32,in=-32,looseness=.9] ++(.3mm,2.65mm) to[bend left=17] ([yshift=-\pingu@devilhorns@yshift]\pingu@name-head-left) -- cycle;
    \pingu@block{\pingu@color@devilhorns} ([yshift=-\pingu@devilhorns@yshift]\pingu@name-head-left) to [bend right=38] (\pingu@name-devilhorns-left-goal) to[bend right=30] ([yshift=-\pingu@devilhorns@yshift]\pingu@name-head-left) -- cycle;
    \pingu@block{\pingu@color@devilhorns@b} ([yshift=-\pingu@devilhorns@yshift]\pingu@name-head-right) arc (\pingu@devilhorns@baseang@r:\pingu@devilhorns@baseang@r+\pingu@devilhorns@baseoff:\pingu@w@half{} and .9\pingu@w@half) coordinate (\pingu@name-devilhorns-right-goal) to[out=148,in=-148,looseness=.9] ++(-.3mm,2.65mm) to[bend right=17] ([yshift=-\pingu@devilhorns@yshift]\pingu@name-head-right) -- cycle;
    \pingu@block{\pingu@color@devilhorns@b} ([yshift=-\pingu@devilhorns@yshift]\pingu@name-head-right) to [bend left=38] (\pingu@name-devilhorns-right-goal) to[bend left=30] ([yshift=-\pingu@devilhorns@yshift]\pingu@name-head-right) -- cycle;
}

% ########...#######...#######..##....##
% ##.....##.##.....##.##.....##.##...##.
% ##.....##.##.....##.##.....##.##..##..
% ########..##.....##.##.....##.#####...
% ##...##...##.....##.##.....##.##..##..
% ##....##..##.....##.##.....##.##...##.
% ##.....##..#######...#######..##....##
\newif\if@pingu@x@rook@draw@hatch@
\pingu@create@extra{rook}{%
    rook/.code          = \pingu@set@extra{rook}{true}\pingu@color{rook}{#1},
    rook back/.code     = \pingu@color{rook@back}{#1},
    rook hatch/.is if   = @pingu@x@rook@draw@hatch@,
    rook hatch/.default = true,
    rook shade/.code    = \pingu@color{rook@shade}{#1},
    rook/.default       = pingu@silver,
}{rook back=\pingu@color@rook!85!black,rook shade=\pingu@color@rook!92!black,rook hatch}

\def\pingu@draw@ea@rook{%
    \pingu@block[even odd rule]{\pingu@color@rook} ([xshift=-.2mm]\pingu@name-wings-side-right|-\pingu@name-foot-right) [rounded corners=\p@] to[bend right=5] coordinate[pos=.15] (@tmpe) ([xshift=.2mm]\pingu@name-wings-side-left|-\pingu@name-foot-left) [sharp corners] to[bend right=1.5*\pingu@bend] (\pingu@name-wings-side-left|-\pingu@name-head-top) coordinate (@tmp) to[bend left=3] coordinate[pos=.3] (@tmpc) coordinate[pos=.7] (@tmpd) (\pingu@name-wings-side-right|-\pingu@name-head-top) [rounded corners=\p@] coordinate (@tmpb) to[bend right=1.5*\pingu@bend] cycle \if@pingu@x@rook@draw@hatch@ (\pingu@name-head-center) ellipse[x radius=.8\pingu@w@half, y radius=.45\pingu@w@half]\fi;
    \pingu@block{\pingu@color@rook} (@tmp) to[bend right=2] ++(0,2mm) [rounded corners=.25mm] to[bend left=1] ++(-2mm,-.1mm) -- ++(0,-2.25mm);
    \pingu@block{\pingu@color@rook} (@tmpb) to[bend left=2] ++(0,2mm) [rounded corners=.25mm] to[bend right=1] ++(2mm,-.1mm) -- ++(0,-2.25mm);

    \pingu@block{\pingu@color@rook} (@tmpc)++(-2mm,-.25mm) [rounded corners=.25mm] to[bend left=2] ++(0,2.25mm) to[bend right=1] ++(4mm,.05mm) -- ++(0,-2.25mm);
    \pingu@block{\pingu@color@rook} (@tmpd)++(2mm,-.25mm) [rounded corners=.25mm] to[bend left=2] ++(0,2.25mm) to[bend left=1] ++(-4mm,-.05mm) -- ++(0,-2.25mm);

    % custom shade boi (or gurl, wateva)
    \scope
        \clip ([xshift=-.2mm]\pingu@name-wings-side-right|-\pingu@name-foot-right) [rounded corners=\p@] to[bend right=5] ([xshift=.2mm]\pingu@name-wings-side-left|-\pingu@name-foot-left) [sharp corners] to[bend right=1.5*\pingu@bend] (\pingu@name-wings-side-left|-\pingu@name-head-top) -- ++(0,2mm) to[bend left=3] (\pingu@name-wings-side-right|-\pingu@name-head-top) to[bend right=1.5*\pingu@bend] cycle;
        \if@pingu@x@rook@draw@hatch@
        \clip[/pingu/@invclip] (\pingu@name-head-center) ellipse[x radius=.8\pingu@w@half, y radius=.45\pingu@w@half];
        \fi
        \pingu@block{\pingu@color@rook@shade} (@tmpe) to[bend right=5] ([xshift=.2mm]@tmpe-|@tmp) to[bend right=1.5*\pingu@bend] ([yshift=2mm]@tmp) to[bend left=10] cycle;
    \endscope

    \pingu@layer{background}[]
        \pingu@block{\pingu@color@rook@back} (@tmp) to[bend right=3] coordinate[pos=.3] (@tmpc) coordinate[pos=.7] (@tmpd) (@tmpb) to[bend right=30] cycle;
        \pingu@block{\pingu@color@rook@back} (@tmpb) to[bend left=2] ++(0,2mm) [rounded corners=.25mm] to[bend left=1] ++(2mm,.1mm) -- ++(0,-2.25mm);
        \pingu@block{\pingu@color@rook@back} (@tmp) to[bend right=2] ++(0,2mm) [rounded corners=.25mm] to[bend right=1] ++(-2mm,.1mm) -- ++(0,-2.25mm);

        \pingu@block{\pingu@color@rook@back} (@tmpc)++(-2mm,-.49mm) [rounded corners=.25mm] to[bend left=2] ++(0,2.25mm) to[bend right=1] ++(4mm,.05mm) -- ++(0,-2.25mm);
        \pingu@block{\pingu@color@rook@back} (@tmpd)++(2mm,-.49mm) [rounded corners=.25mm] to[bend left=2] ++(0,2.25mm) to[bend left=1] ++(-4mm,-.05mm) -- ++(0,-2.25mm);
    \endpingu@layer
}

%     #endregion
% #endregion

% #region wingitems
%     #region wingitems-setup
\def\pingu@may@draw@wing#1#2{\csname if@pingu@x@#1#2@\endcsname \csname pingu@draw@wi@#1\endcsname{#2}\fi}
\edef\pingu@str@wing@left{left}
\newif\if@pingu@wing@item@side@left@
\def\pingu@setup@wing#1#2{%
    \edef\@tmpa{#2}% minus on left
    \ifx\pingu@str@wing@left\@tmpa
        \expandafter\def\expandafter\@angle{\csname @pingu@wingangle@\csname @pingu@select@#2wing@\endcsname @\endcsname}%
        \@pingu@wing@item@side@left@true
    \else
        \expandafter\def\expandafter\@angle{-(\csname @pingu@wingangle@\csname @pingu@select@#2wing@\endcsname @\endcsname)}%
        \@pingu@wing@item@side@left@false
    \fi
    \expandafter\def\expandafter\@col{\csname pingu@color@#1#2\endcsname}%
}

\def\pingu@draw@wing@items{%
\pingu@layer{middle}[]\csname @pingu@wingitem@\@pingu@select@leftwing@ @\endcsname
    \@pingu@draw@wing@items@left\else
    \@pingu@draw@wing@items@left
\fi\endpingu@layer
\pingu@layer{middle}[]\csname @pingu@wingitem@\@pingu@select@rightwing@ @\endcsname
    \@pingu@draw@wing@items@right\else
    \@pingu@draw@wing@items@right
\fi\endpingu@layer
}

\let\@pingu@draw@wing@items@left\@empty
\let\@pingu@draw@wing@items@right\@empty

\def\pingu@create@wing@extra#1#2#3{%
\expandafter\def\expandafter\@pingu@draw@wing@items@left\expandafter{\@pingu@draw@wing@items@left\pingu@may@draw@wing{#1}{left}}%
\expandafter\def\expandafter\@pingu@draw@wing@items@right\expandafter{\@pingu@draw@wing@items@right\pingu@may@draw@wing{#1}{right}}%
\def\@lr{left}%
\protected@edef\@tmp{\expandafter\expandafter\expandafter\expandafter\expandafter\unexpanded{{#1left}{#2}{#3}}}%
\expandafter\pingu@create@extra\@tmp
\def\@lr{right}%
\protected@edef\@tmp{\expandafter\expandafter\expandafter\expandafter\expandafter\unexpanded{{#1right}{#2}{#3}}}%
\expandafter\pingu@create@extra\@tmp}
%     #endregion

%     #region lillipop
\pingu@create@wing@extra{lollipop}{%
  lollipop \@lr/.code         = {\pingu@set@extra{lollipop\@lr}{true}\pingu@color{lollipop\@lr}{##1}},
  lollipop \@lr/.default      = pingu@green,
  lollipop \@lr\space handle/.code = \pingu@color{lollipop\@lr @handle}{##1},%
  lollipop \@lr\space second/.code = \pingu@color{lollipop\@lr @second}{##1}%
}{lollipop \@lr\space handle=pingu@bronze,lollipop \@lr\space second={\csname pingu@color@lollipop\@lr\endcsname!86!white}}

% #1 wing
\def\pingu@draw@wi@lollipop#1{%
    \pingu@setup@wing{lollipop}{#1}%
    \pingu@draw[thick,rotate around={\@angle:(\pingu@name-wing-#1)}]{\csname pingu@color@lollipop#1@handle\endcsname}(\pingu@name-wing-#1)++(0,4.75mm) -- ++(0,-6.25mm);
    \pingu@block[thick,rotate around={\@angle:(\pingu@name-wing-#1)}]{\@col}(\pingu@name-wing-#1)++(0,4.75mm) coordinate (\pingu@name-lollipop-#1-top) circle[radius=1.4mm];
    \pingu@block[thick,rotate around={\@angle-1:(\pingu@name-lollipop-#1-top)}]{\csname pingu@color@lollipop#1@second\endcsname} (\pingu@name-lollipop-#1-top) ellipse [x radius=1.57mm, y radius=1.5\p@];
    \pingu@block[thick,rotate around={\@angle-1:(\pingu@name-lollipop-#1-top)}]{\@col} (\pingu@name-lollipop-#1-top)++(0,.5\p@) ellipse [x radius=1.4mm, y radius=\p@];
}
%     #endregion

%     #region cane
\pingu@create@wing@extra{cane}{%
  cane \@lr/.code         = {\pingu@set@extra{cane\@lr}{true}\pingu@color{cane\@lr}{##1}},
  cane \@lr/.default      = pingu@bronze,
}{}

% #1 wing
\def\pingu@draw@wi@cane#1{%
    \pingu@setup@wing{cane}{#1}%
    \if@pingu@wing@item@side@left@
        \pingu@block[thick,rotate around={\@angle+5:(\pingu@name-wing-#1)}]{\@col}(\pingu@name-wing-#1)++(0,-7mm) -- ++(0,15mm) arc(180:0:2.25mm and 2.2mm) arc(360:180:.3mm and .275mm) arc(0:180:1.65mm and 1.65mm) -- ++(0,-15mm) arc(360:180:.3mm and .275mm) -- cycle;
    \else
        \pingu@block[thick,rotate around={\@angle-5:(\pingu@name-wing-#1)}]{\@col}(\pingu@name-wing-#1)++(0,-7mm) -- ++(0,15mm) arc(0:180:2.25mm and 2.2mm) arc(180:360:.3mm and .275mm) arc(180:0:1.65mm and 1.65mm) -- ++(0,-15mm) arc(180:360:.3mm and .275mm) -- cycle;
    \fi
}
%     #endregion

%     #region handcast
\pingu@create@wing@extra{handcast}{%
  handcast \@lr/.forward to    = hand cast \@lr,
  hand cast \@lr/.code         = {\pingu@set@extra{handcast\@lr}{true}\@namedef{pingu@handcast@\@lr}{##1}},
  hand cast \@lr/.default      = {X},
  handcast \@lr\space color/.forward to    = hand cast \@lr\space color,
  hand cast \@lr\space color/.code = \pingu@color{handcast@\@lr @color}{##1},%
}{hand cast \@lr\space color=pingu@purple}
\def\pingu@draw@wi@handcast#1{%
    \pingu@setup@wing{handcast}{#1}%
    \path[rotate around={\@angle:(\pingu@name-wing-#1)}] (\pingu@name-wing-#1)++(0,5mm) node[\csname pingu@color@handcast@\@lr @color\endcsname] {\@nameuse{pingu@handcast@#1}};
}
%     #endregion

%     #region lightsaber
\newif\if@pingu@x@lightsaber@glow@left
\newif\if@pingu@x@lightsaber@glow@right
\newif\if@pingu@x@lightsaber@double@left
\newif\if@pingu@x@lightsaber@double@right
\def\pingu@x@saberglow@w@half{.9mm}
\def\pingulightsaberfactor{.0225}
\pingu@create@wing@extra{lightsaber}{%
  lightsaber \@lr/.code                = {\pingu@set@extra{lightsaber\@lr}{true}\pingu@color{lightsaber\@lr}{##1}},
  lightsaber \@lr/.default             = pingu@blue,
  lightsaber \@lr\space handle/.code   = \pingu@color{lightsaber\@lr @handle}{##1},%
  lightsaber \@lr\space deco/.code     = \pingu@color{lightsaber\@lr @deco}{##1},%
  lightsaber \@lr\space ribbs/.code    = \pingu@color{lightsaber\@lr @ribbs}{##1},%
  lightsaber \@lr\space button/.code   = \pingu@color{lightsaber\@lr @button}{##1},%
  lightsaber \@lr\space button b/.code   = \pingu@color{lightsaber\@lr @button@b}{##1},%
  lightsaber \@lr\space color b/.code   = \pingu@color{lightsaber\@lr @color@b}{##1},%
  lightsaber \@lr\space angle/.code    = {\@namedef{pingu@x@lightsaber@angle@\@lr}{##1}},%
  lightsaber \@lr\space length/.code   = {\@namedef{pingu@x@lightsaber@length@\@lr}{##1}},%
  lightsaber \@lr\space length b/.code   = {\@namedef{pingu@x@lightsaber@length@b@\@lr}{##1}},%
  lightsaber \@lr\space yshift/.code   = {\@namedef{pingu@x@lightsaber@yshift@\@lr}{##1}},%
  lightsaber \@lr\space glow/.is if    = @pingu@x@lightsaber@glow@\@lr,%
  lightsaber \@lr\space double/.is if  = @pingu@x@lightsaber@double@\@lr,%
  % TODO: lower color
  lightsaber \@lr\space glow core/.code   = \pingu@color{lightsaber\@lr @glow@core}{##1},%
  lightsaber \@lr\space solid/.style = {/pingu/lightsaber \@lr\space glow=false},
  lightsaber \@lr\space disabled/.style = {/pingu/lightsaber \@lr\space solid,/pingu/lightsaber \@lr=\@pingu@none},
  lightsaber \@lr\space outer glow factor/.code  = {\@namedef{pingu@x@lightsaber@ogf@\@lr}{##1}}%
}{lightsaber \@lr\space handle=pingu@silver, lightsaber \@lr\space deco=pingu@silver!12!pingu@black, lightsaber \@lr\space button=pingu@red!85!pingu@black,lightsaber \@lr\space button b=pingu@red!85!pingu@black, lightsaber \@lr\space ribbs=pingu@silver!50!pingu@black,lightsaber \@lr\space angle=0,lightsaber \@lr\space length=2cm,lightsaber \@lr\space glow=\ifpengu@setup@glows@ true\else false\fi,lightsaber \@lr\space glow core=white,lightsaber \@lr\space outer glow factor=\pingulightsaberfactor,lightsaber \@lr\space yshift=\z@,lightsaber \@lr\space length b=\csname pingu@x@lightsaber@length@\@lr\endcsname,lightsaber \@lr\space color b=\noexpand\@col}

\def\pingu@draw@wi@lightsaber@base#1{%
% deco-elements
    % base
    \pingu@block{\csname pingu@color@lightsaber#1@deco\endcsname}(\pingu@name-wing-#1)++(-.4mm,2.65mm+\csname pingu@x@lightsaber@yshift@#1\endcsname) -- ++(0,-5mm) -- ++(.8mm,0) |- cycle;
    \if@pingu@wing@item@side@left@
    % ribbs; single path saves memory :D
    \pingu@block{\csname pingu@color@lightsaber#1@ribbs\endcsname}(\pingu@name-wing-#1)++(-.45mm,2.225mm+\csname pingu@x@lightsaber@yshift@#1\endcsname)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -| ++(.8mm,-.165mm) -- ++(-.8mm,0)
    arc(90:270:.075mm) -- ++(.8mm,0) |- cycle;
    % button
    \pingu@block{\csname pingu@color@lightsaber#1@button@b\endcsname}(\pingu@name-wing-#1)++(.49mm,-1.75mm+\csname pingu@x@lightsaber@yshift@#1\endcsname) ellipse [x radius=.1mm, y radius=.3mm];
    \pingu@block{\csname pingu@color@lightsaber#1@button\endcsname}(\pingu@name-wing-#1)++(.49mm,1.9mm+\csname pingu@x@lightsaber@yshift@#1\endcsname) ellipse [x radius=.1mm, y radius=.3mm];
    % cover
    \pingu@block{\csname pingu@color@lightsaber#1@handle\endcsname}(\pingu@name-wing-#1)++(-.5mm,2.65mm+\csname pingu@x@lightsaber@yshift@#1\endcsname) arc(180:90:.15mm) -- ++(.7mm,0) arc(90:0:.16mm) -- ++(0,-5mm) arc(360:270:.15mm) -- ++(-.7mm,0) arc (270:180:.15mm) -- ++(0,.25mm) arc(270:360:.33mm and .2mm) -- ++(0,4.1mm) arc(0:90:.33mm and .2mm) -- ++(0,.25mm) -- cycle;
    \else
    % ribbs; single path saves memory :D (the second)
    \pingu@block{\csname pingu@color@lightsaber#1@ribbs\endcsname}(\pingu@name-wing-#1)++(.45mm,2.225mm+\csname pingu@x@lightsaber@yshift@#1\endcsname)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -| ++(-.8mm,-.165mm) -- ++(.8mm,0)
        arc(90:-90:.075mm) -- ++(-.8mm,0) |- cycle;
    % buttons
    \pingu@block{\csname pingu@color@lightsaber#1@button@b\endcsname}(\pingu@name-wing-#1)++(-.49mm,-1.75mm+\csname pingu@x@lightsaber@yshift@#1\endcsname) ellipse [x radius=.1mm, y radius=.3mm];
    \pingu@block{\csname pingu@color@lightsaber#1@button\endcsname}(\pingu@name-wing-#1)++(-.49mm,1.9mm+\csname pingu@x@lightsaber@yshift@#1\endcsname) ellipse [x radius=.1mm, y radius=.3mm];
    % cover
    \pingu@block{\csname pingu@color@lightsaber#1@handle\endcsname}(\pingu@name-wing-#1)++(.5mm,2.65mm+\csname pingu@x@lightsaber@yshift@#1\endcsname) arc(0:90:.15mm) -- ++(-.7mm,0) arc(90:180:.16mm) -- ++(0,-5mm) arc(180:270:.15mm) -- ++(.7mm,0) arc (270:360:.15mm) -- ++(0,.25mm) arc(270:180:.33mm and .2mm) -- ++(0,4.1mm) arc(180:90:.33mm and .2mm) -- ++(0,.25mm) -- cycle;
    \fi
}

% #1 wing, #2 yshift, #3 angle, #4 length, #5 color
\def\pingu@draw@wi@lightsaber@pre#1#2#3#4#5{
    \scope[rotate around={#3:(\pingu@name-wing-#1)}]
    \csname if@pingu@x@lightsaber@glow@#1\endcsname
    \@for\i:={0,2,4,6,7,8,9,10,11,12,13,14,15,16,17}\do{
        \pingu@block[fill opacity=\ifnum\i>14 .225\else.1\fi*\i/20]{#5} (\pingu@name-wing-#1)++(-\pingu@x@saberglow@w@half+\i*\i mm/440,#2) -- ++(.05mm,#4) arc(180:0:\pingu@x@saberglow@w@half-.05mm-\i*\i mm/440 and \ifnum\i>14 .85mm\else 1mm\fi-\i mm/30) -- ++(.05mm,-#4) arc (0:-180:\pingu@x@saberglow@w@half-\i*\i mm/440 and .35mm);
    }
    \else % draw solid
        \pingu@block{#5} (\pingu@name-wing-#1)++(-.425mm,#2-.1mm) -- ++(.05mm,#4) arc(180:0:.375mm and .375mm) -- ++(.05mm,-#4) arc (0:-180:.425mm and .05mm);
    \fi
    \endscope
}

% #1 wing, #2 yshift, #3 angle, #4 length, #5 color
\def\pingu@draw@wi@lightsaber@post#1#2#3#4#5{
    \scope[rotate around={#3:(\pingu@name-wing-#1)}]
    \ifdim\csname pingu@x@lightsaber@ogf@\@lr\endcsname pt>\z@
    \pgfinterruptboundingbox\pingu@layer{foreground}[]
    \@for\i:={1,1.1,1.2,1.3}\do{
        \pingu@block[/pingu/@glow,fill opacity=\csname pingu@x@lightsaber@ogf@\@lr\endcsname/\i]{#5} (\pingu@name-wing-#1) ++(.05mm,#2+#4/2) circle[radius=\i*#4];
    }
    \endpingu@layer\endpgfinterruptboundingbox
    \fi
    \csname if@pingu@x@lightsaber@glow@#1\endcsname
        % fadings hat a rotation angle bug
        \@for\i:={1,2}\do{
            \pingu@block[fill opacity=.125*\i/10]{#5} (\pingu@name-wing-#1)++(-\pingu@x@saberglow@w@half+\i*\i mm/440,#2) -- ++(.05mm,#4) arc(180:0:\pingu@x@saberglow@w@half-.05mm-\i*\i mm/440 and 1mm-\i mm/30) -- ++(.05mm,-#4) arc (0:-180:\pingu@x@saberglow@w@half-\i*\i mm/440 and .35mm);
        }
        \pingu@block{\csname pingu@color@lightsaber#1@glow@core\endcsname} (\pingu@name-wing-#1)++(-.275mm,#2-.1mm) -- ++(.1mm,#4) arc(180:0:.175mm and .25mm) -- ++(.1mm,-#4) arc (0:-180:.275mm and .065mm);
    \fi
    \endscope
}

% #1 wing
\def\pingu@draw@wi@lightsaber#1{%
    \pingu@setup@wing{lightsaber}{#1}%
    \scope[rotate around={\@angle+\csname pingu@x@lightsaber@angle@#1\endcsname:([yshift=+\csname pingu@x@lightsaber@yshift@#1\endcsname]\pingu@name-wing-#1)},xscale=1.2]
    \pingu@draw@wi@lightsaber@pre{#1}{2.9mm+\csname pingu@x@lightsaber@yshift@#1\endcsname}{0}{\csname pingu@x@lightsaber@length@#1\endcsname}{\@col}
    \csname if@pingu@x@lightsaber@double@#1\endcsname
    \pingu@draw@wi@lightsaber@pre{#1}{2.65mm-\csname pingu@x@lightsaber@yshift@#1\endcsname}{180}{\csname pingu@x@lightsaber@length@b@#1\endcsname}{\csname pingu@color@lightsaber#1@color@b\endcsname}
    \fi
    \pingu@draw@wi@lightsaber@base{#1}
    % afterglow (whuile watching everglow :D)
    \pingu@draw@wi@lightsaber@post{#1}{2.9mm+\csname pingu@x@lightsaber@yshift@#1\endcsname}{0}{\csname pingu@x@lightsaber@length@#1\endcsname}{\@col}
    \csname if@pingu@x@lightsaber@double@#1\endcsname
    \pingu@draw@wi@lightsaber@post{#1}{2.65mm-\csname pingu@x@lightsaber@yshift@#1\endcsname}{180}{\csname pingu@x@lightsaber@length@b@#1\endcsname}{\csname pingu@color@lightsaber#1@color@b\endcsname}
    \fi
    \endscope
}
%     #endregion
% #endregion

% #region clothes

\def\pingu@draw@clothing@behind{%
    \if@pingu@x@cloak@ \pingu@draw@cloth@cloak@behind \fi
}

\def\pingu@draw@clothing@main{%
    \if@pingu@x@cloak@ \pingu@draw@cloth@cloak \fi
}

%     #region cloaks
\pingu@create@extra{cloak}{%
    cape/.forward to         = /pingu/cloak, % TODO: update if it changes
    cloak/.code              = \pingu@set@extra{cloak}{true}\pingu@color{cloak}{#1},
    cloak/.default           = pingu@bronze,
    cloak bottom color/.code = \pingu@color{cloak@bottom}{#1},
    cloak padding/.code      = {\def\pingu@x@cloak@padding{#1}}
}{cloak padding=3.5mm,cloak bottom color=\pingu@color@cloak}
\def\pingu@draw@cloth@cloak@behind{%
    \pingu@block[bottom color=\pingu@color@cloak@bottom,top color=\pingu@color@cloak]{\pingu@color@cloak} (\pingu@name-bottom-center)++(-\pingu@x@cloak@padding-\pingu@w@half,-.5mm) arc (180:0:{\pingu@x@cloak@padding+\pingu@w@half} and 1mm) to[bend left=1] (\pingu@name-wings-side-left) arc(0:180:\pingu@w@half{} and .75mm) to[bend left=1] cycle;
}
\def\pingu@draw@cloth@cloak{%
    % cape
    \pingu@block{\pingu@color@cloak} ([yshift=-4mm]\pingu@name-wings-side-left)
    -- ++(-.15mm,1.6mm) to[bend right=3] ([yshift=2mm]\pingu@name-head)
    to[bend right=3] ([xshift=.15mm,yshift=1.6mm-4mm]\pingu@name-wings-side-right) -- ++(-.15mm,-1.6mm)
    arc (270:180:.44mm and .8mm)
    arc (180:0:\pingu@w@half+.44mm and 1.3\pingu@w@half+4mm)
    arc (0:-90:.44mm and .8mm);
}
%     #endregion

% #endregion

\let\pingu@create@selection\relax
\let\pingu@create@extra\relax
\endinput